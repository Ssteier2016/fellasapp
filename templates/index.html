<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Showroom +Roma - Tienda Online</title>
    <style>
        /* Base styles and resets */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Open+Sans:wght@400;700&family=Lato:wght@400;700&family=Montserrat:wght@400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        /* Loading Screen */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 0.8s ease-out;
        }

        .loading-screen.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .logo-animation {
            width: 150px;
            height: 150px;
            margin-bottom: 30px;
            animation: logoFloat 2s ease-in-out infinite, logoScale 1s ease-out;
        }

        .logo-animation img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: drop-shadow(0 0 10px rgba(255,255,255,0.5));
        }

        @keyframes logoFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-15px); }
        }

        @keyframes logoScale {
            from { transform: scale(0.5); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .brand-text {
            color: white;
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
            opacity: 0;
            animation: fadeInUp 1s ease 0.8s forwards;
            text-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .loading-bar {
            width: 80%;
            max-width: 400px;
            height: 6px;
            background: rgba(255,255,255,0.3);
            border-radius: 3px;
            overflow: hidden;
            margin-top: 30px;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
        }

        .loading-progress {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #4ecdc4);
            width: 0%;
            animation: loadProgress 2.5s ease forwards;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(40px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes loadProgress {
            to { width: 100%; }
        }

        /* Header */
        .header {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            width: 100%;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo {
            width: 50px;
            height: 50px;
        }

        .logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .brand-name {
            font-size: 1.8rem;
            font-weight: bold;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 2rem;
            align-items: center;
        }

        .nav-item {
            cursor: pointer;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            transition: all 0.3s ease;
            font-weight: 600;
            color: #555;
        }

        .nav-item:hover {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
        }

        .nav-item.active-nav {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .cart-icon, .user-icon {
            position: relative;
            cursor: pointer;
            padding: 12px;
            border-radius: 50%;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .cart-icon:hover, .user-icon:hover {
            transform: scale(1.15);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff6b6b;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: bold;
            border: 2px solid white;
        }

        /* Main Content */
        .main-content {
            margin-top: 100px;
            padding: 2rem;
            flex-grow: 1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }

        /* Hero Section */
        .hero {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 3rem;
            text-align: center;
            margin-bottom: 3rem;
            box-shadow: 0 12px 40px rgba(0,0,0,0.15);
            overflow: hidden;
        }

        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: slideInFromLeft 0.8s ease-out;
        }

        .hero p {
            font-size: 1.3rem;
            color: #666;
            margin-bottom: 2.5rem;
            animation: slideInFromRight 0.8s ease-out;
        }

        @keyframes slideInFromLeft {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideInFromRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .hero .btn {
            padding: 15px 30px;
            font-size: 1.1rem;
            border-radius: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        /* Carousel */
        .carousel-container {
            position: relative;
            margin-bottom: 3rem;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            height: 400px;
            width: 100%;
        }

        .carousel {
            display: flex;
            transition: transform 0.5s ease-in-out;
            height: 100%;
            width: 100%;
        }

        .carousel-slide {
            min-width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2.2rem;
            font-weight: bold;
            text-shadow: 0 2px 5px rgba(0,0,0,0.2);
            padding: 1rem;
            text-align: center;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .carousel-slide:nth-child(1) { background-image: url('https://placehold.co/1200x400/ff6b6b/ffffff?text=Ofertas+Especiales'); }
        .carousel-slide:nth-child(2) { background-image: url('https://placehold.co/1200x400/4ecdc4/ffffff?text=Subastas+en+Vivo'); }
        .carousel-slide:nth-child(3) { background-image: url('https://placehold.co/1200x400/667eea/ffffff?text=Nuevos+Modelos'); }

        .carousel-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.8);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 2rem;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
            z-index: 10;
        }

        .carousel-nav:hover {
            background: white;
            transform: translateY(-50%) scale(1.15);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .carousel-prev {
            left: 20px;
        }

        .carousel-next {
            right: 20px;
        }

        /* Section Title */
        .section-title {
            font-size: 2.8rem;
            text-align: center;
            margin: 3.5rem 0 2.5rem;
            color: white;
            text-shadow: 0 4px 15px rgba(0,0,0,0.4);
        }

        /* Product Grid */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
            justify-content: center;
        }

        .product-card {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 12px 40px rgba(0,0,0,0.15);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .product-card:hover {
            transform: translateY(-12px);
            box-shadow: 0 18px 50px rgba(0,0,0,0.25);
        }

        .product-image {
            width: 100%;
            height: 250px;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: #666;
            position: relative;
            overflow: hidden;
            border-bottom: 1px solid #eee;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .product-card:hover .product-image img {
            transform: scale(1.05);
        }

        .offer-badge, .auction-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #ff6b6b;
            color: white;
            padding: 7px 18px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            z-index: 5;
        }

        .auction-badge {
            background: #4ecdc4;
            left: 15px;
            right: auto;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.08); opacity: 0.9; }
            100% { transform: scale(1); opacity: 1; }
        }

        .product-info {
            padding: 1.5rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .product-name {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 0.8rem;
            color: #444;
        }

        .product-prices {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.2rem;
        }

        .price-original {
            text-decoration: line-through;
            color: #999;
            font-size: 1.1rem;
        }

        .price-offer {
            color: #ff6b6b;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .price-regular {
            color: #333;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .offer-timer, .auction-timer {
            background: linear-gradient(45deg, #ff6b6b, #ff8e53);
            color: white;
            padding: 10px 15px;
            border-radius: 12px;
            text-align: center;
            font-weight: bold;
            margin-bottom: 1rem;
            font-size: 1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .auction-info {
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            color: white;
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 1rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .auction-current-bid {
            font-size: 1.4rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .auction-timer {
            font-size: 1.1rem;
            margin-bottom: 15px;
            background: rgba(255,255,255,0.2);
        }

        .bid-input {
            display: flex;
            gap: 10px;
            margin-top: auto;
            align-items: stretch;
        }

        .bid-input input {
            flex: 1;
            padding: 10px 12px;
            border: none;
            border-radius: 8px;
            outline: none;
            font-size: 1rem;
            color: #333;
        }

        .bid-btn {
            background: #fff;
            color: #4ecdc4;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .bid-btn:hover {
            background: #f0f0f0;
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .product-actions {
            display: flex;
            gap: 1rem;
            margin-top: auto;
            padding-top: 1rem;
            border-top: 1px solid #eee;
        }

        .btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 1.05rem;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }

        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }

        .btn-secondary {
            background: transparent;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.25);
        }

        .btn-auction {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(8px);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            overflow-y: auto;
            padding: 20px;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 2.5rem;
            border-radius: 25px;
            max-width: 550px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 15px 50px rgba(0,0,0,0.3);
            animation: fadeInScale 0.3s ease-out;
        }

        @keyframes fadeInScale {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-close {
            position: absolute;
            top: 20px;
            right: 25px;
            background: none;
            border: none;
            font-size: 2.5rem;
            cursor: pointer;
            color: #aaa;
            transition: color 0.2s ease;
        }

        .modal-close:hover {
            color: #333;
        }

        .modal-content h2 {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            text-align: center;
            color: #667eea;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.8rem;
            font-weight: bold;
            color: #444;
            font-size: 1.05rem;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 14px;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            font-size: 1.05rem;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            background-color: #fcfcfc;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102,126,234,0.3);
        }

        .modal-content .btn-primary, .modal-content .btn-secondary {
            width: 100%;
            margin-top: 1rem;
        }

        .modal-content p a {
            font-weight: bold;
        }

        /* Cart Styles */
        .cart-item {
            display: flex;
            align-items: center;
            gap: 1.2rem;
            padding: 1.2rem;
            border-bottom: 1px solid #eee;
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .cart-item img {
            width: 90px;
            height: 90px;
            object-fit: cover;
            border-radius: 12px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-weight: bold;
            margin-bottom: 0.6rem;
            font-size: 1.1rem;
        }

        .cart-item-price {
            color: #667eea;
            font-weight: bold;
            font-size: 1.05rem;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }

        .quantity-btn {
            width: 35px;
            height: 35px;
            border: none;
            background: #667eea;
            color: white;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.2rem;
            transition: background 0.2s ease, transform 0.2s ease;
        }

        .quantity-btn:hover {
            background: #5a67d8;
            transform: scale(1.05);
        }

        .remove-item {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            transition: background 0.2s ease, transform 0.2s ease;
        }

        .remove-item:hover {
            background: #ff5252;
            transform: translateY(-2px);
        }

        /* Cart Summary */
        .cart-summary {
            border-top: 2px solid #eee;
            padding-top: 1.5rem;
            margin-top: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .cart-summary-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
        }

        .cart-summary-total {
            font-size: 1.5rem;
            color: #667eea;
        }

        /* Payment Methods Section */
        .payment-methods {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2.5rem;
            margin: 2rem auto;
            max-width: 600px;
            text-align: center;
            box-shadow: 0 12px 40px rgba(0,0,0,0.15);
        }

        .payment-methods .section-title {
            color: #333;
            margin: 0 0 2rem 0;
            text-shadow: none;
        }

        .payment-method-single-btn {
            padding: 18px 30px;
            font-size: 1.3rem;
            border-radius: 15px;
            margin-top: 1.5rem;
            display: inline-block;
            background: linear-gradient(45deg, #00C853, #1DD1A1);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            text-decoration: none;
        }

        .payment-method-single-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }

        /* Auction Modal Styles */
        .auction-modal-content {
            background: linear-gradient(135deg, #4ecdc4, #44a08d);
            color: white;
        }

        .auction-modal-content h2 {
            color: white;
        }

        .auction-form .form-group label {
            color: white;
        }

        .auction-form .form-group input, .auction-form .form-group select {
            background-color: rgba(255,255,255,0.9);
            border-color: rgba(255,255,255,0.5);
            color: #333;
        }

        .auction-form .form-group input::placeholder {
            color: #666;
        }

        .auction-form .form-group input:focus, .auction-form .form-group select:focus {
            border-color: white;
            box-shadow: 0 0 0 3px rgba(255,255,255,0.3);
        }

        .time-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 12px;
            margin-top: 15px;
        }

        .time-option {
            padding: 12px;
            background: rgba(255,255,255,0.2);
            border: 2px solid transparent;
            border-radius: 12px;
            cursor: pointer;
            text-align: center;
            font-weight: bold;
            font-size: 1rem;
            color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .time-option:hover, .time-option.selected {
            background: rgba(255,255,255,0.4);
            border-color: white;
            transform: translateY(-3px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        /* Footer */
        .footer {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            padding: 3.5rem 2rem 2.5rem;
            margin-top: 4rem;
            border-radius: 25px 25px 0 0;
            box-shadow: 0 -5px 30px rgba(0,0,0,0.1);
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
        }

        .footer h3 {
            color: #667eea;
            margin-bottom: 1.5rem;
            font-size: 1.8rem;
        }

        .footer p {
            color: #666;
            margin-bottom: 0.7rem;
            font-size: 1.05rem;
        }

        /* Loading animation for buttons */
        .btn.loading {
            position: relative;
            color: transparent !important;
            pointer-events: none;
        }

        .btn.loading::after {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 25px;
            height: 25px;
            border: 3px solid transparent;
            border-top: 3px solid white;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        /* Notification Toast */
        .notification-toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 1rem;
            opacity: 0;
            transition: opacity 0.3s ease-out, bottom 0.3s ease-out;
            z-index: 3000;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification-toast.show {
            opacity: 1;
            bottom: 50px;
        }

        /* Product Detail Section */
        .product-detail {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: 0 12px 40px rgba(0,0,0,0.15);
            margin-bottom: 3rem;
        }

        .product-detail-carousel {
            height: 500px;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            border-radius: 15px;
        }

        .product-detail-carousel .carousel-slide {
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            width: 100%;
            height: 100%;
            flex-shrink: 0;
        }

        .product-detail-info {
            text-align: center;
        }

        .product-detail-description {
            color: #666;
            font-size: 1.1rem;
            line-height: 1.8;
            margin: 2rem auto;
            max-width: 700px;
            text-align: left;
        }

        .product-detail-price-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .product-detail-price-info .price-list {
            font-size: 1.3rem;
            color: #999;
            text-decoration: line-through;
            margin-bottom: 0.5rem;
        }

        .product-detail-price-info .price-offer-display {
            font-size: 2.2rem;
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 0.5rem;
        }

        .product-detail-price-info .price-regular-display {
            font-size: 2.2rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .product-detail-price-info .discount-tag {
            background: #4ecdc4;
            color: white;
            padding: 5px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: bold;
        }

        /* Gift Card and Coupon Card Section Styles */
        #giftCardManagementSection, #couponCardManagementSection {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 12px 40px rgba(0,0,0,0.15);
            margin-bottom: 3rem;
        }

        #giftCardManagementSection .header, #couponCardManagementSection .header {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }

        #giftCardManagementSection .header h1, #couponCardManagementSection .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: none;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        #giftCardManagementSection .header p, #couponCardManagementSection .header p {
            font-size: 1.1em;
            opacity: 0.9;
            color: #555;
        }

        #giftCardManagementSection .main-content, #couponCardManagementSection .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        #giftCardManagementSection .gift-card-container, #couponCardManagementSection .coupon-card-container {
            perspective: 1000px;
            width: 100%;
            /* Increased height for coupon card to accommodate 10 circles */
            height: 300px; /* Adjusted from 250px */
            margin-bottom: 20px;
        }

        #giftCardManagementSection .gift-card, #couponCardManagementSection .coupon-card {
            position: relative;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            cursor: pointer;
        }

        #giftCardManagementSection .gift-card:hover, #couponCardManagementSection .coupon-card:hover {
            transform: rotateY(180deg);
        }

        #giftCardManagementSection .card-front, #giftCardManagementSection .card-back,
        #couponCardManagementSection .card-front, #couponCardManagementSection .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
            background-size: cover; /* Ensure background image covers the card */
            background-position: center; /* Center the background image */
        }

        /* Base styles for card fronts - will be overridden by model-specific styles */
        #giftCardManagementSection .card-front, #couponCardManagementSection .card-front {
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 20px;
            /* Ensure text color and font family are applied directly */
            color: var(--card-text-color, white);
            font-family: var(--card-font-family, 'Inter', sans-serif);
        }

        #couponCardManagementSection .card-front {
            display: flex;
            flex-direction: column;
            justify-content: space-between; /* Distribute content vertically */
            align-items: center; /* Center horizontally */
            padding: 20px;
            text-align: center;
        }


        #giftCardManagementSection .card-back, #couponCardManagementSection .card-back {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            transform: rotateY(180deg);
            color: white;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        #giftCardManagementSection .logo-section, #couponCardManagementSection .logo-section {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        #couponCardManagementSection .logo-section {
            margin-bottom: 0; /* Adjust spacing for new layout */
            width: 100%;
            justify-content: center;
        }

        #giftCardManagementSection .logo-icon, #couponCardManagementSection .logo-icon {
            width: 40px;
            height: 40px;
            border: 2px solid white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.1);
        }
        
        #giftCardManagementSection .logo-icon img, #couponCardManagementSection .logo-icon img {
            width: 30px;
            height: 30px;
            object-fit: contain;
        }

        #giftCardManagementSection .brand-name, #couponCardManagementSection .brand-name {
            font-size: 18px;
            font-weight: 700;
            letter-spacing: 1px;
        }

        #giftCardManagementSection .gift-card-title, #couponCardManagementSection .coupon-card-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
        }
        #couponCardManagementSection .coupon-card-title {
            font-size: 2.2em; /* Larger title */
            font-weight: 800;
            margin: 10px 0; /* Adjust margin */
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            flex-grow: 1; /* Allow it to take available space */
            display: flex;
            align-items: center;
            justify-content: center;
        }


        #giftCardManagementSection .card-number, #couponCardManagementSection .card-number {
            font-size: 18px;
            font-weight: 500;
            letter-spacing: 2px;
            margin-bottom: 15px;
            text-align: center;
            background: rgba(255,255,255,0.1);
            padding: 8px;
            border-radius: 8px;
        }
        #couponCardManagementSection .card-number {
            font-size: 1.1em;
            letter-spacing: 1px;
            margin-top: auto; /* Push to bottom */
            background: none; /* Remove background for cleaner look */
            padding: 0;
            border-radius: 0;
            opacity: 0.8;
        }


        #giftCardManagementSection .recipient-name, #couponCardManagementSection .recipient-name {
            font-size: 16px;
            margin-bottom: 10px;
            text-align: center;
            background: rgba(255,255,255,0.1);
            padding: 8px;
            border-radius: 8px;
        }
        #couponCardManagementSection .recipient-name {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 10px;
            background: none; /* Remove background for cleaner look */
            padding: 0;
            border-radius: 0;
        }

        #giftCardManagementSection .amount {
            font-size: 28px;
            font-weight: 700;
            text-align: center;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        #giftCardManagementSection .card-footer, #couponCardManagementSection .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            opacity: 0.8;
        }
        #couponCardManagementSection .card-footer {
            width: 100%; /* Ensure footer spans full width */
            justify-content: space-around; /* Distribute items evenly */
            margin-top: 10px; /* Add some space from content above */
            font-size: 0.9em;
        }


        #giftCardManagementSection .description, #couponCardManagementSection .description {
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 20px;
            text-align: center;
        }

        #couponCardManagementSection .coupon-details {
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 20px;
            text-align: center;
        }
        /* New class for main content on coupon card front */
        #couponCardManagementSection .coupon-main-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex-grow: 1; /* Allow it to take available space */
            justify-content: center;
            width: 100%;
        }


        #giftCardManagementSection .address, #couponCardManagementSection .address {
            font-size: 12px;
            margin-bottom: 15px;
            text-align: center;
            background: rgba(255,255,255,0.1);
            padding: 8px;
            border-radius: 8px;
        }

        #giftCardManagementSection .qr-section, #couponCardManagementSection .qr-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        #giftCardManagementSection .qr-section img, #couponCardManagementSection .qr-section img {
            width: 100px;
            height: 100px;
            border-radius: 8px;
            background: white;
            padding: 5px;
        }

        #giftCardManagementSection .qr-text, #couponCardManagementSection .qr-text {
            font-size: 11px;
            opacity: 0.9;
        }

        #giftCardManagementSection .decorative-elements, #couponCardManagementSection .decorative-elements {
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            border-radius: 50%;
            transform: translate(30px, -30px);
        }

        #giftCardManagementSection .form-section, #couponCardManagementSection .form-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        #giftCardManagementSection .form-section h3, #couponCardManagementSection .form-section h3 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        #giftCardManagementSection .form-group, #couponCardManagementSection .form-group {
            margin-bottom: 15px;
        }

        #giftCardManagementSection .form-group label, #couponCardManagementSection .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-weight: 500;
        }

        #giftCardManagementSection .form-group input, #giftCardManagementSection .form-group select,
        #couponCardManagementSection .form-group input, #couponCardManagementSection .form-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        #giftCardManagementSection .form-group input:focus, #giftCardManagementSection .form-group select:focus,
        #couponCardManagementSection .form-group input:focus, #couponCardManagementSection .form-group select:focus {
            outline: none;
            border-color: #ff6b6b;
        }

        #giftCardManagementSection .form-buttons, #couponCardManagementSection .form-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        #giftCardManagementSection .btn, #couponCardManagementSection .btn {
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        #giftCardManagementSection .btn:hover, #couponCardManagementSection .btn:hover {
            transform: translateY(-2px);
        }

        #giftCardManagementSection .btn-primary, #couponCardManagementSection .btn-primary {
            background: linear-gradient(135deg, #ff6b6b 0%, #ffa726 100%);
            color: white;
        }

        #giftCardManagementSection .btn-secondary, #couponCardManagementSection .btn-secondary {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
            color: white;
        }

        #giftCardManagementSection .btn-success, #couponCardManagementSection .btn-success {
            background: linear-gradient(135deg, #51cf66 0%, #40c057 100%);
            color: white;
        }

        #giftCardManagementSection .btn-danger, #couponCardManagementSection .btn-danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #e55353 100%);
            color: white;
        }

        #giftCardManagementSection .btn-warning, #couponCardManagementSection .btn-warning {
            background: linear-gradient(135deg, #ffd43b 0%, #fab005 100%);
            color: white;
        }

        #giftCardManagementSection .history-section, #couponCardManagementSection .history-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-top: 30px;
        }

        #giftCardManagementSection .history-section h3, #couponCardManagementSection .history-section h3 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        #giftCardManagementSection .history-controls, #couponCardManagementSection .history-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        #giftCardManagementSection .search-box, #couponCardManagementSection .search-box {
            flex: 1;
            min-width: 200px;
        }

        #giftCardManagementSection .search-box input, #couponCardManagementSection .search-box input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
        }

        #giftCardManagementSection .filter-select, #couponCardManagementSection .filter-select {
            min-width: 150px;
        }

        #giftCardManagementSection .history-table, #couponCardManagementSection .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        #giftCardManagementSection .history-table th,
        #giftCardManagementSection .history-table td,
        #couponCardManagementSection .history-table th,
        #couponCardManagementSection .history-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        #giftCardManagementSection .history-table th,
        #couponCardManagementSection .history-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }

        #giftCardManagementSection .history-table tr:hover,
        #couponCardManagementSection .history-table tr:hover {
            background: #f8f9fa;
        }

        #giftCardManagementSection .status, #couponCardManagementSection .status {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        #giftCardManagementSection .status.active, #couponCardManagementSection .status.active {
            background: #d4edda;
            color: #155724;
        }

        #giftCardManagementSection .status.used, #couponCardManagementSection .status.used {
            background: #f8d7da;
            color: #721c24;
        }

        #giftCardManagementSection .status.redeemed, #couponCardManagementSection .status.redeemed {
            background: #fff3cd;
            color: #856404;
        }

        #giftCardManagementSection .action-buttons, #couponCardManagementSection .action-buttons {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        #giftCardManagementSection .action-btn, #couponCardManagementSection .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            transition: opacity 0.2s;
        }

        #giftCardManagementSection .action-btn:hover, #couponCardManagementSection .action-btn:hover {
            opacity: 0.8;
        }

        #giftCardManagementSection .no-records, #couponCardManagementSection .no-records {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 40px;
        }

        /* Coupon Card Specific Styles */
        #couponCardManagementSection .purchase-circles {
            display: grid;
            grid-template-columns: repeat(5, 1fr); /* 5 columns for better spacing */
            gap: 8px; /* Reduced gap */
            margin: 15px auto; /* Center the grid */
            width: 95%; /* Control width of the circles container */
            max-width: 280px; /* Max width for larger screens */
        }

        #couponCardManagementSection .circle {
            width: 40px; /* Slightly smaller circles */
            height: 40px; /* Slightly smaller circles */
            border: 2px solid currentColor; /* Border uses text color for better contrast */
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1em; /* Adjusted font size */
            font-weight: bold;
            text-align: center;
            background: rgba(255,255,255,0.2);
            color: inherit; /* Inherit text color */
            transition: background 0.3s ease, border-color 0.3s ease;
        }

        #couponCardManagementSection .circle.filled {
            background: #28a745; /* Darker green for filled */
            color: white; /* White text for filled circles */
            border-color: #28a745; /* Border matches filled color */
            box-shadow: 0 0 8px rgba(40, 167, 69, 0.5); /* Glowing effect */
        }

        .coupon-canje-indicator {
            font-size: 1.5em;
            font-weight: bold;
            color: #FFFF00; /* Bright yellow for emphasis */
            margin-top: 15px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
            animation: pulse-canje 1.5s infinite alternate;
        }

        @keyframes pulse-canje {
            0% { transform: scale(1); opacity: 0.8; }
            100% { transform: scale(1.05); opacity: 1; }
        }

        /* Circle control buttons */
        .circle-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
            margin-bottom: 20px;
        }

        .circle-control-btn {
            background: #667eea;
            color: white;
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: transform 0.2s ease, background 0.2s ease;
        }

        .circle-control-btn:hover {
            transform: scale(1.1);
            background: #5a67d8;
        }


        /* Responsive Design */
        @media (max-width: 992px) {
            .nav-menu {
                gap: 1rem;
            }
            .nav-item {
                padding: 0.6rem 1rem;
                font-size: 0.9rem;
            }
            .brand-name {
                font-size: 1.5rem;
            }
            .hero h1 {
                font-size: 2.8rem;
            }
            .hero p {
                font-size: 1.1rem;
            }
            .section-title {
                font-size: 2.2rem;
            }
            .product-grid {
                grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
                gap: 1.5rem;
            }
            .product-card {
                padding-bottom: 1rem;
            }
            .product-detail-carousel {
                height: 400px;
            }
        }

        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
                gap: 1rem;
            }
            .nav-menu {
                width: 100%;
                justify-content: center;
                flex-wrap: wrap;
                gap: 0.8rem;
            }
            .nav-item {
                padding: 0.5rem 0.8rem;
                font-size: 0.85rem;
            }
            .cart-icon, .user-icon {
                padding: 10px;
                font-size: 1rem;
            }
            .cart-count {
                width: 20px;
                height: 20px;
                font-size: 0.75rem;
                top: -5px;
                right: -5px;
            }
            .hero {
                padding: 2rem 1rem;
            }
            .hero h1 {
                font-size: 2.2rem;
            }
            .hero p {
                font-size: 1rem;
            }
            .carousel-container {
                height: 300px;
            }
            .carousel-slide {
                font-size: 1.8rem;
            }
            .carousel-nav {
                width: 40px;
                height: 40px;
                font-size: 1.5rem;
            }
            .main-content {
                padding: 1rem;
            }
            .section-title {
                font-size: 1.8rem;
                margin: 2.5rem 0 1.5rem;
            }
            .product-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            .modal-content {
                padding: 1.5rem;
                max-width: 95%;
            }
            .modal-content h2 {
                font-size: 1.6rem;
            }
            .form-group label {
                font-size: 1rem;
            }
            .form-group input, .form-group select {
                padding: 10px;
                font-size: 0.95rem;
            }
            .btn {
                padding: 12px;
                font-size: 1rem;
            }
            .bid-input input {
                padding: 8px;
                font-size: 0.9rem;
            }
            .bid-btn {
                padding: 8px 12px;
                font-size: 0.9rem;
            }
            .product-detail-carousel {
                height: 300px;
            }
            .product-detail {
                padding: 1.5rem;
            }
            .product-detail-description {
                font-size: 1rem;
            }
            .payment-methods {
                padding: 1.5rem;
            }
            .payment-method-single-btn {
                font-size: 1.1rem;
                padding: 15px 25px;
            }

            /* Gift Card and Coupon Card Section Responsive */
            #giftCardManagementSection .main-content, #couponCardManagementSection .main-content {
                grid-template-columns: 1fr;
            }
            
            #giftCardManagementSection .form-buttons, #couponCardManagementSection .form-buttons {
                grid-template-columns: 1fr;
            }
            
            #giftCardManagementSection .history-controls, #couponCardManagementSection .history-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            #giftCardManagementSection .history-table, #couponCardManagementSection .history-table {
                font-size: 12px;
            }
            
            #giftCardManagementSection .action-buttons, #couponCardManagementSection .action-buttons {
                flex-direction: column;
            }

            #couponCardManagementSection .purchase-circles {
                grid-template-columns: repeat(3, 1fr);
            }
            #couponCardManagementSection .coupon-card-container {
                height: 280px; /* Adjusted for smaller screens */
            }
        }

        @media (max-width: 480px) {
            .nav-menu {
                gap: 0.5rem;
            }
            .nav-item {
                font-size: 0.8rem;
            }
            .brand-name {
                font-size: 1.2rem;
            }
            .hero h1 {
                font-size: 1.8rem;
            }
            .hero p {
                font-size: 0.9rem;
            }
            .carousel-container {
                height: 250px;
            }
            .carousel-slide {
                font-size: 1.5rem;
            }
            .section-title {
                font-size: 1.5rem;
            }
            .product-info {
                padding: 1rem;
            }
            .product-name {
                font-size: 1.1rem;
            }
            .price-offer, .price-regular {
                font-size: 1.3rem;
            }
            .btn {
                padding: 10px;
                font-size: 0.9rem;
            }
            .bid-input input {
                padding: 8px;
                font-size: 0.9rem;
            }
            .bid-btn {
                padding: 8px 12px;
                font-size: 0.9rem;
            }
            .product-detail-carousel {
                height: 200px;
            }
        }

        /* Print-specific styles for the gift card */
        @media print {
            body > *:not(#print-area) {
                display: none !important; /* Hide everything except the print area */
            }

            #print-area {
                display: flex !important;
                justify-content: center;
                align-items: center;
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                margin: 0;
                padding: 0;
                background: white; /* Ensure white background for printing */
            }

            #print-area .gift-card-container,
            #print-area .coupon-card-container {
                width: 90%; /* Adjust width for print */
                max-width: 600px; /* Max width for print */
                height: auto; /* Allow height to adjust */
                margin: auto; /* Center the container */
                perspective: none; /* Disable perspective for print */
                box-shadow: none; /* Remove shadow for print */
            }

            #print-area .gift-card,
            #print-area .coupon-card {
                transform: none !important; /* Ensure no rotation */
                width: 100%;
                height: auto;
                aspect-ratio: 1.586 / 1; /* Maintain aspect ratio (credit card ratio) */
                box-shadow: 0 5px 15px rgba(0,0,0,0.2); /* Add a subtle shadow for definition */
                border: 1px solid #ddd; /* Add a light border */
            }

            #print-area .card-back {
                display: none !important; /* Hide the back of the card */
            }

            #print-area .decorative-elements {
                display: none !important; /* Hide decorative elements */
            }

            #print-area .logo-section .logo-icon {
                border: none !important;
                background: none !important;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="logo-animation">
            <img src="https://raw.githubusercontent.com/Ssteier2016/fellasapp/main/imagen/logo2.png" alt="Showroom +Roma Logo" loading="lazy">
        </div>
        <div class="brand-text">Showroom +Roma</div>
        <div class="loading-bar">
            <div class="loading-progress"></div>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="nav-container">
            <div class="logo-container">
                <div class="logo">
                    <img src="https://raw.githubusercontent.com/Ssteier2016/fellasapp/main/imagen/logo2.png" alt="Showroom +Roma Logo" loading="lazy">
                </div>
                <div class="brand-name">Showroom +Roma</div>
            </div>
            <nav>
                <ul class="nav-menu">
                    <li class="nav-item active-nav" onclick="showSection('home', this)">Inicio</li>
                    <li class="nav-item" onclick="showSection('catalog', this)">Catlogo</li>
                    <li class="nav-item" onclick="showSection('auctions', this)">Subastas</li>
                    <li class="nav-item" onclick="showSection('payments', this)">Pagos</li>
                    <li class="nav-item" onclick="showSection('giftCardManagement', this)">Gift Cards</li>
                    <li class="nav-item" onclick="showSection('couponCardManagement', this)">Cuponera</li>
                    <li class="cart-icon" onclick="toggleCart()">
                        
                        <span class="cart-count" id="cartCount">0</span>
                    </li>
                    <li class="user-icon" onclick="toggleUserMenu()"></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Home Section -->
            <section id="homeSection">
                <div class="hero">
                    <h1>Zapatillas nicas e importadas</h1>
                    <p>Descubre nuestra exclusiva coleccin de zapatillas importadas con los mejores precios y ofertas especiales</p>
                    <button class="btn btn-primary" onclick="showSection('catalog', document.querySelector('.nav-item[onclick*=\'catalog\']'))">Ver Catlogo</button>
                </div>

                <!-- Carousel -->
                <div class="carousel-container">
                    <div class="carousel" id="carousel">
                        <div class="carousel-slide" style="background: linear-gradient(45deg, #ff6b6b, #ff8e53);">
                             OFERTAS ESPECIALES! Hasta 50% de descuento
                        </div>
                        <div class="carousel-slide" style="background: linear-gradient(45deg, #4ecdc4, #44a08d);">
                             SUBASTAS EN VIVO - Puja por tus favoritas
                        </div>
                        <div class="carousel-slide" style="background: linear-gradient(45deg, #667eea, #764ba2);">
                             NUEVOS MODELOS - Recin llegados
                        </div>
                    </div>
                    <button class="carousel-nav carousel-prev" onclick="prevSlide()"></button>
                    <button class="carousel-nav carousel-next" onclick="nextSlide()"></button>
                </div>
            </section>

            <!-- Catalog Section -->
            <section id="catalogSection" style="display: none;">
                <h2 class="section-title">Nuestro Catlogo</h2>
                <div class="product-grid" id="productGrid">
                    <!-- Products will be generated by JavaScript -->
                </div>
            </section>

            <!-- Auctions Section -->
            <section id="auctionsSection" style="display: none;">
                <h2 class="section-title">Subastas Activas</h2>
                <button class="btn btn-auction" onclick="showModal('auctionModal')" style="margin-bottom: 1.5rem;">Crear Nueva Subasta</button>
                <div class="product-grid" id="auctionGrid">
                    <!-- Auction products will be generated by JavaScript -->
                </div>
            </section>

            <!-- Payment Methods Section -->
            <section id="paymentsSection" style="display: none;">
                <div class="payment-methods">
                    <h2 class="section-title" style="color: #333; margin: 0 0 2rem 0; text-shadow: none;">Mtodos de Pago</h2>
                    <p style="text-align: center; margin-bottom: 2rem; color: #666; font-size: 1.1rem;">
                        Realiza tu pago de forma segura a travs de Mercado Pago o por transferencia bancaria.
                    </p>
                    <!-- Botn de Mercado Pago -->
                    <button class="payment-method-single-btn" onclick="openCheckoutInfoModal()">
                        Pagar con Mercado Pago
                    </button>
                    <!-- Informacin de transferencia bancaria -->
                    <div style="text-align: center; margin-top: 2rem; color: #333;">
                        <p style="font-weight: bold; font-size: 1.1rem; margin-bottom: 0.5rem;">
                            Tambin puedes pagar por transferencia bancaria:
                        </p>
                        <p style="font-size: 1rem; color: #666;">
                            <strong>Alias:</strong> Showroomasroma<br>
                            <strong>CVU:</strong> 0000003100091982420429
                        </p>
                        <p style="font-size: 0.9rem; color: #ff6b6b; margin-top: 0.5rem;">
                            Si usas transferencia, por favor enva la captura de pantalla del comprobante va WhatsApp (+5491124689196).
                        </p>
                    </div>
                </div>
            </section>

            <!-- Product Detail Section -->
            <section id="productDetailSection" style="display: none;">
                <div class="container">
                    <button class="btn btn-secondary" onclick="showSection('catalog', document.querySelector('.nav-item[onclick*=\'catalog\']'))" style="margin-bottom: 1.5rem;"> Volver al Catlogo</button>
                    <div class="product-detail">
                        <h2 class="section-title" id="productDetailName"></h2>
                        <div class="carousel-container product-detail-carousel">
                            <div class="carousel" id="productDetailCarousel"></div>
                            <button class="carousel-nav carousel-prev" onclick="prevProductSlide()"></button>
                            <button class="carousel-nav carousel-next" onclick="nextProductSlide()"></button>
                        </div>
                        <div class="product-detail-info">
                            <p id="productDetailDescription" class="product-detail-description"></p>
                            <div class="product-detail-price-info">
                                <span id="productDetailListPrice" class="price-list" style="display: none;"></span>
                                <span id="productDetailOfferPrice" class="price-offer-display" style="display: none;"></span>
                                <span id="productDetailRegularPrice" class="price-regular-display" style="display: none;"></span>
                                <span id="productDetailDiscount" class="discount-tag" style="display: none;"></span>
                            </div>
                            <div id="productDetailTimer"></div>
                            <div class="product-actions">
                                <button class="btn btn-primary" id="productDetailAddToCart">Agregar al Carrito</button>
                                <button class="btn btn-secondary" id="productDetailBuyNow" onclick="openCheckoutInfoModal()">Comprar Ahora</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Gift Card Management Section -->
            <section id="giftCardManagementSection" style="display: none;">
                <div class="container">
                    <div class="header">
                        <h1>SHOWROOM +ROMA</h1>
                        <p>Sistema de Gestin de Gift Cards</p>
                    </div>

                    <div class="main-content">
                        <div class="card-preview">
                            <div class="gift-card-container">
                                <div class="gift-card" id="giftCard">
                                    <div class="card-front">
                                        <div class="decorative-elements"></div>
                                        <div class="logo-section">
                                            <div class="logo-icon">
                                                <img src="https://raw.githubusercontent.com/Ssteier2016/fellasapp/main/imagen/logo2.png" alt="Showroom +Roma Logo">
                                            </div>
                                            <div class="brand-name">SHOWROOM +ROMA</div>
                                        </div>
                                        
                                        <div class="card-details">
                                            <div class="gift-card-title">GIFT CARD</div>
                                            <div class="card-number" id="cardNumber">XXXX-XXXX-XXXX</div>
                                            <div class="recipient-name" id="recipientName">NOMBRE DEL DESTINATARIO</div>
                                            <div class="amount" id="amount">$0</div>
                                        </div>
                                        
                                        <div class="card-footer">
                                            <span>Vlida por 12 meses</span>
                                            <span>Ropa Importada</span>
                                        </div>
                                    </div>
                                    
                                    <div class="card-back">
                                        <div class="description">
                                            <strong>Tu Gift Card SHOWROOM +ROMA!</strong><br>
                                            Canjeable por ropa importada exclusiva. Vlida en nuestro local fsico. No acumulable con otras promociones.
                                        </div>
                                        
                                        <div class="address">
                                             <strong>Direccin:</strong><br>
                                            Av. Rivadavia 7055 Local 52<br>
                                            Flores, Buenos Aires
                                        </div>
                                        
                                        <div class="qr-section">
                                            <img src="uploaded:image.png-63d8d13f-b70a-4921-aacb-6c165548b445" alt="WhatsApp QR Code">
                                            <div class="qr-text">Escanea para ver nuestro catlogo en WhatsApp</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-section">
                            <h3>Crear Nueva Gift Card</h3>
                            <div class="form-group">
                                <label for="recipientInput">Nombre del destinatario:</label>
                                <input type="text" id="recipientInput" placeholder="Ingresa el nombre">
                            </div>
                            <div class="form-group">
                                <label for="amountInput">Monto:</label>
                                <input type="number" id="amountInput" placeholder="Ingresa el monto" min="0" step="1">
                            </div>
                            <div class="form-group">
                                <label for="giftCardModel">Modelo de Tarjeta:</label>
                                <select id="giftCardModel">
                                    <!-- Options populated by JavaScript -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="giftCardBgColor">Color de Fondo:</label>
                                <input type="color" id="giftCardBgColor" value="#ff6b6b">
                            </div>
                            <div class="form-group">
                                <label for="giftCardTextColor">Color de Texto:</label>
                                <input type="color" id="giftCardTextColor" value="#ffffff">
                            </div>
                            <div class="form-group">
                                <label for="giftCardFontFamily">Fuente del Texto:</label>
                                <select id="giftCardFontFamily">
                                    <option value="Inter, sans-serif">Inter</option>
                                    <option value="Roboto, sans-serif">Roboto</option>
                                    <option value="Open Sans, sans-serif">Open Sans</option>
                                    <option value="Lato, sans-serif">Lato</option>
                                    <option value="Montserrat, sans-serif">Montserrat</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="giftCardBgImageUpload">Subir Imagen de Fondo:</label>
                                <input type="file" id="giftCardBgImageUpload" accept="image/*">
                            </div>
                            <div class="form-buttons">
                                <button class="btn btn-primary" onclick="generateGiftCard()">Crear Gift Card</button>
                                <button class="btn btn-secondary" onclick="printCard()">Imprimir Tarjeta</button>
                            </div>
                        </div>
                    </div>

                    <div class="history-section">
                        <h3>Historial de Gift Cards</h3>
                        <div class="history-controls">
                            <div class="search-box">
                                <input type="text" id="searchInput" placeholder="Buscar por nombre o nmero..." onkeyup="filterHistory()">
                            </div>
                            <select id="statusFilter" class="filter-select" onchange="filterHistory()">
                                <option value="">Todos los estados</option>
                                <option value="active">Activas</option>
                                <option value="used">Usadas</option>
                            </select>
                        </div>
                        
                        <table class="history-table" id="historyTable">
                            <thead>
                                <tr>
                                    <th>Nmero</th>
                                    <th>Nombre</th>
                                    <th>Monto</th>
                                    <th>Creacin</th>
                                    <th>Estado</th>
                                    <th>Fecha Uso</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="historyBody">
                                <tr>
                                    <td colspan="7" class="no-records">No hay gift cards registradas</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Coupon Card Management Section -->
            <section id="couponCardManagementSection" style="display: none;">
                <div class="container">
                    <div class="header">
                        <h1>SHOWROOM +ROMA</h1>
                        <p>Sistema de Gestin de Cuponera</p>
                    </div>

                    <div class="main-content">
                        <div class="card-preview">
                            <div class="coupon-card-container">
                                <div class="coupon-card" id="couponCard">
                                    <div class="card-front">
                                        <div class="decorative-elements"></div>
                                        <div class="logo-section">
                                            <div class="logo-icon">
                                                <img src="https://raw.githubusercontent.com/Ssteier2016/fellasapp/main/imagen/logo2.png" alt="Showroom +Roma Logo">
                                            </div>
                                            <div class="brand-name">SHOWROOM +ROMA</div>
                                        </div>
                                        
                                        <div class="coupon-main-content">
                                            <div class="coupon-card-title">CUPONERA</div>
                                            <div class="recipient-name" id="couponRecipientName">NOMBRE DEL DESTINATARIO</div>
                                            
                                            <!-- Purchase circles will be dynamically generated here -->
                                            <div class="purchase-circles" id="couponPurchaseCircles"></div>

                                            <div class="coupon-canje-indicator" id="couponCanjeIndicator" style="display: none;">
                                                CANJE DISPONIBLE!
                                            </div>

                                            <div class="card-number" id="couponCardNumber">XXXX-XXXX-XXXX</div>
                                        </div>
                                        
                                        <div class="card-footer">
                                            <span>Vlida por 12 meses</span>
                                            <span>Ropa Importada</span>
                                        </div>
                                    </div>
                                    
                                    <div class="card-back">
                                        <div class="description">
                                            <strong>Tu Cuponera SHOWROOM +ROMA!</strong><br>
                                            Registra tus compras en los crculos. Cada crculo debe ser de un da diferente.
                                            <br><br>
                                            <strong>Acumula compras y gana!</strong><br>
                                            - 5 compras: 45% OFF en una prenda<br>
                                            - 10 compras: 90% OFF en una prenda<br>
                                            Para compras mayores de $8000, un sticker por dia.
                                        </div>
                                        
                                        <div class="address">
                                             <strong>Direccin:</strong><br>
                                            Av. Rivadavia 7055 Local 52<br>
                                            Flores, Buenos Aires
                                        </div>
                                        
                                        <div class="qr-section">
                                            <img src="uploaded:image.png-63d8d13f-b70a-4921-aacb-6c165548b445" alt="WhatsApp QR Code">
                                            <div class="qr-text">Escanea para ver nuestro catlogo en WhatsApp</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="circle-controls">
                                <button class="circle-control-btn" onclick="removeCouponCircle()">-</button>
                                <button class="circle-control-btn" onclick="addCouponCircle()">+</button>
                            </div>
                        </div>

                        <div class="form-section">
                            <h3>Crear Nueva Cuponera</h3>
                            <div class="form-group">
                                <label for="couponRecipientInput">Nombre del destinatario:</label>
                                <input type="text" id="couponRecipientInput" placeholder="Ingresa el nombre">
                            </div>
                            <div class="form-group">
                                <label for="couponCardModel">Modelo de Tarjeta:</label>
                                <select id="couponCardModel">
                                    <!-- Options populated by JavaScript -->
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="couponCircleCount">Nmero de Crculos (1-10):</label>
                                <input type="number" id="couponCircleCount" value="10" min="1" max="10">
                            </div>
                            <div class="form-group">
                                <label for="couponBgColor">Color de Fondo:</label>
                                <input type="color" id="couponBgColor" value="#FF7F50">
                            </div>
                            <div class="form-group">
                                <label for="couponTextColor">Color de Texto:</label>
                                <input type="color" id="couponTextColor" value="#ffffff">
                            </div>
                            <div class="form-group">
                                <label for="couponFontFamily">Fuente del Texto:</label>
                                <select id="couponFontFamily">
                                    <option value="Inter, sans-serif">Inter</option>
                                    <option value="Roboto, sans-serif">Roboto</option>
                                    <option value="Open Sans, sans-serif">Open Sans</option>
                                    <option value="Lato, sans-serif">Lato</option>
                                    <option value="Montserrat, sans-serif">Montserrat</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="couponBgImageUpload">Subir Imagen de Fondo:</label>
                                <input type="file" id="couponBgImageUpload" accept="image/*">
                            </div>
                            <div class="form-buttons">
                                <button class="btn btn-primary" onclick="generateCouponCard()">Crear Cuponera</button>
                                <button class="btn btn-secondary" onclick="printCouponCard()">Imprimir Tarjeta</button>
                            </div>
                        </div>
                    </div>

                    <div class="history-section">
                        <h3>Historial de Cuponeras</h3>
                        <div class="history-controls">
                            <div class="search-box">
                                <input type="text" id="couponSearchInput" placeholder="Buscar por nombre o nmero..." onkeyup="filterCouponHistory()">
                            </div>
                            <select id="couponStatusFilter" class="filter-select" onchange="filterCouponHistory()">
                                <option value="">Todos los estados</option>
                                <option value="active">Activas</option>
                                <option value="redeemed">Canjeadas</option>
                            </select>
                        </div>
                        
                        <table class="history-table" id="couponHistoryTable">
                            <thead>
                                <tr>
                                    <th>Nmero</th>
                                    <th>Nombre</th>
                                    <th>Compras</th>
                                    <th>Crculos</th>
                                    <th>Creacin</th>
                                    <th>Estado</th>
                                    <th>Fecha Canje</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody id="couponHistoryBody">
                                <tr>
                                    <td colspan="8" class="no-records">No hay cuponeras registradas</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Modals -->
            <!-- Cart Modal -->
            <div class="modal" id="cartModal">
                <div class="modal-content">
                    <button class="modal-close" onclick="closeModal('cartModal')">&times;</button>
                    <h2>Tu Carrito</h2>
                    <div id="cartItems"></div>
                    <div class="cart-summary" id="cartSummary" style="display: none;">
                        <div class="cart-summary-row">
                            <span>Subtotal:</span>
                            <span id="cartSubtotal">$0.00</span>
                        </div>
                        <div class="cart-summary-row">
                            <span>Descuento:</span>
                            <span id="cartDiscount">$0.00</span>
                        </div>
                        <div class="cart-summary-row">
                            <span>Total:</span>
                            <span id="cartTotal" class="cart-summary-total">$0.00</span>
                        </div>
                        <button class="btn btn-primary" onclick="openCheckoutInfoModal()">Proceder al Pago</button>
                    </div>
                    <p id="emptyCartMessage">Tu carrito est vaco.</p>
                </div>
            </div>

            <!-- Checkout Info Modal -->
            <div class="modal" id="checkoutInfoModal">
                <div class="modal-content">
                    <button class="modal-close" onclick="closeModal('checkoutInfoModal')">&times;</button>
                    <h2>Informacin de Pago</h2>
                    <p>Por favor, completa tu compra a travs de Mercado Pago o transferencia bancaria.</p>
                    <p><strong>Alias:</strong> Showroomasroma</p>
                    <p><strong>CVU:</strong> 0000003100091982420429</p>
                    <p style="color: #ff6b6b; font-size: 0.9rem; margin-top: 1rem;">
                        Si usas transferencia, enva la captura del comprobante va WhatsApp (+5491124689196).
                    </p>
                    <div class="form-group">
                        <label for="couponCardInput">Cuponera (Opcional):</label>
                        <input type="text" id="couponCardInput" placeholder="Ingresa el nmero de la cuponera">
                    </div>
                    <button class="btn btn-primary" onclick="applyCouponCard()">Aplicar Cuponera</button>
                    <button class="btn btn-secondary" onclick="closeModal('checkoutInfoModal')">Cerrar</button>
                </div>
            </div>

            <!-- Auction Modal -->
            <div class="modal" id="auctionModal">
                <div class="modal-content auction-modal-content">
                    <button class="modal-close" onclick="closeModal('auctionModal')">&times;</button>
                    <h2>Crear Nueva Subasta</h2>
                    <div class="auction-form">
                        <div class="form-group">
                            <label for="auctionProductName">Nombre del Producto:</label>
                            <input type="text" id="auctionProductName" placeholder="Ingresa el nombre del producto">
                        </div>
                        <div class="form-group">
                            <label for="auctionBasePrice">Precio Base:</label>
                            <input type="number" id="auctionBasePrice" placeholder="Ingresa el precio base" min="0" step="1">
                        </div>
                        <div class="form-group">
                            <label for="auctionDuration">Duracin de la Subasta:</label>
                            <div class="time-selector" id="auctionDuration">
                                <div class="time-option" data-value="24">24 horas</div>
                                <div class="time-option" data-value="48">48 horas</div>
                                <div class="time-option" data-value="72">72 horas</div>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="createAuction()">Crear Subasta</button>
                    </div>
                </div>
            </div>

            <!-- Register Purchase Modal -->
            <div class="modal" id="registerPurchaseModal">
                <div class="modal-content">
                    <button class="modal-close" onclick="closeModal('registerPurchaseModal')">&times;</button>
                    <h2>Registrar Compra en Cuponera</h2>
                    <div class="form-group">
                        <label for="purchaseCardNumber">Nmero de Cuponera:</label>
                        <input type="text" id="purchaseCardNumber" placeholder="Ingresa el nmero de la cuponera" readonly>
                    </div>
                    <div class="form-group">
                        <label for="purchaseDate">Fecha de Compra:</label>
                        <input type="date" id="purchaseDate">
                    </div>
                    <button class="btn btn-primary" onclick="registerPurchase()">Registrar Compra</button>
                </div>
            </div>

            <!-- Redeem Coupon Modal -->
            <div class="modal" id="redeemCouponModal">
                <div class="modal-content">
                    <button class="modal-close" onclick="closeModal('redeeemCouponModal')">&times;</button>
                    <h2>Canjear Cuponera</h2>
                    <div class="form-group">
                        <label for="redeemCardNumber">Nmero de Cuponera:</label>
                        <input type="text" id="redeemCardNumber" placeholder="Ingresa el nmero de la cuponera" readonly>
                    </div>
                    <button class="btn btn-primary" onclick="redeemCouponCard()">Canjear Descuento</button>
                </div>
            </div>

            <!-- Modify Coupon Modal -->
            <div class="modal" id="modifyCouponModal">
                <div class="modal-content">
                    <button class="modal-close" onclick="closeModal('modifyCouponModal')">&times;</button>
                    <h2>Modificar Cuponera</h2>
                    <input type="hidden" id="modifyCouponId">
                    <div class="form-group">
                        <label for="modifyCouponRecipientName">Nombre del destinatario:</label>
                        <input type="text" id="modifyCouponRecipientName" placeholder="Nuevo nombre">
                    </div>
                    <div class="form-group">
                        <label for="modifyCouponCardModel">Modelo de Tarjeta:</label>
                        <select id="modifyCouponCardModel">
                            <!-- Options populated by JavaScript -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="modifyCouponCircleCount">Nmero de Crculos (1-10):</label>
                        <input type="number" id="modifyCouponCircleCount" min="1" max="10">
                    </div>
                    <div class="form-group">
                        <label for="modifyCouponBgColor">Color de Fondo:</label>
                        <input type="color" id="modifyCouponBgColor">
                    </div>
                    <div class="form-group">
                        <label for="modifyCouponTextColor">Color de Texto:</label>
                        <input type="color" id="modifyCouponTextColor">
                    </div>
                    <div class="form-group">
                        <label for="modifyCouponFontFamily">Fuente del Texto:</label>
                        <select id="modifyCouponFontFamily">
                            <option value="Inter, sans-serif">Inter</option>
                            <option value="Roboto, sans-serif">Roboto</option>
                            <option value="Open Sans, sans-serif">Open Sans</option>
                            <option value="Lato, sans-serif">Lato</option>
                            <option value="Montserrat, sans-serif">Montserrat</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="modifyCouponBgImageUpload">Subir Imagen de Fondo:</label>
                        <input type="file" id="modifyCouponBgImageUpload" accept="image/*">
                    </div>
                    <button class="btn btn-primary" onclick="saveModifiedCouponCard()">Guardar Cambios</button>
                </div>
            </div>

            <!-- Manage Purchases Modal -->
            <div class="modal" id="managePurchasesModal">
                <div class="modal-content">
                    <button class="modal-close" onclick="closeModal('managePurchasesModal')">&times;</button>
                    <h2>Gestionar Compras de Cuponera</h2>
                    <input type="hidden" id="managePurchasesCouponId">
                    <p>Cuponera: <strong id="managePurchasesCardNumber"></strong></p>
                    <div id="purchaseList">
                        <!-- Purchase dates will be listed here -->
                    </div>
                    <button class="btn btn-secondary" onclick="closeModal('managePurchasesModal')">Cerrar</button>
                </div>
            </div>

            <!-- Recharge Gift Card Modal -->
            <div class="modal" id="rechargeModal">
                <div class="modal-content">
                    <button class="modal-close" onclick="closeModal('rechargeModal')">&times;</button>
                    <h2>Recargar Gift Card</h2>
                    <div class="form-group">
                        <label for="rechargeCardNumber">Nmero de Tarjeta:</label>
                        <input type="text" id="rechargeCardNumber" readonly>
                    </div>
                    <div class="form-group">
                        <label for="rechargeCardName">Nombre del Destinatario:</label>
                        <input type="text" id="rechargeCardName" readonly>
                    </div>
                    <div class="form-group">
                        <label for="rechargeCurrentAmount">Monto Actual:</label>
                        <input type="text" id="rechargeCurrentAmount" readonly>
                    </div>
                    <div class="form-group">
                        <label for="rechargeAmount">Monto a Recargar:</label>
                        <input type="number" id="rechargeAmount" placeholder="Ingresa el monto a recargar" min="1" step="1">
                    </div>
                    <button class="btn btn-primary" onclick="confirmRecharge()">Recargar</button>
                </div>
            </div>


            <!-- Confirmation Modal (for replacing window.confirm) -->
            <div id="confirmationModal" class="modal">
                <div class="modal-content">
                    <span class="modal-close" onclick="closeModal('confirmationModal')">&times;</span>
                    <h2 id="confirmationModalTitle">Confirmacin</h2>
                    <p id="confirmationModalMessage" style="text-align: center; margin-bottom: 20px;"></p>
                    <div class="form-buttons">
                        <button class="btn btn-danger" id="confirmActionBtn">S</button>
                        <button class="btn btn-secondary" onclick="closeModal('confirmationModal')">No</button>
                    </div>
                </div>
            </div>

            <!-- Notification Toast -->
            <div class="notification-toast" id="notificationToast">
                <span id="notificationMessage"></span>
            </div>
        </div>
    </main>

    <!-- Hidden Print Area -->
    <div id="print-area" style="display: none;"></div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <h3>Showroom +Roma</h3>
            <p> Av. Rivadavia 7055 Local 52, Flores, Buenos Aires</p>
            <p> Contacto: +5491124689196</p>
            <p> Email: showroomasroma@gmail.com</p>
        </div>
    </footer>

    <script>
        // Utility Functions
        function generateUUID() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                const r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }

        function formatDate(date) {
            // Ensure date is a Date object
            const d = new Date(date);
            return d.toLocaleDateString('es-AR', { day: '2-digit', month: '2-digit', year: 'numeric' });
        }

        function showNotification(message, duration = 3000) {
            const toast = document.getElementById('notificationToast');
            const messageElement = document.getElementById('notificationMessage');
            messageElement.textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), duration);
        }

        // Modal Functions
        function showModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // --- Card Model Definitions ---
        // Predefined models with linear gradients or placeholder image URLs
        const couponCardModels = {
            'model-classic': { name: 'Clsico', background: 'linear-gradient(135deg, #FF7F50 0%, #FF6347 100%)', backgroundUrl: '' },
            'model-ocean': { name: 'Ocano', background: 'linear-gradient(135deg, #4ECDC4 0%, #49A09D 100%)', backgroundUrl: '' },
            'model-sunset': { name: 'Atardecer', background: 'linear-gradient(135deg, #FFD700 0%, #FFA500 100%)', backgroundUrl: '' },
            'model-forest': { name: 'Bosque', background: '', backgroundUrl: 'https://placehold.co/600x400/32CD32/FFFFFF?text=Forest' },
            'model-galaxy': { name: 'Galaxia', background: '', backgroundUrl: 'https://placehold.co/600x400/4B0082/FFFFFF?text=Galaxy' }
        };

        const giftCardModels = {
            'model-classic': { name: 'Clsico', background: 'linear-gradient(135deg, #ff6b6b 0%, #ffa726 100%)', backgroundUrl: '' },
            'model-elegant': { name: 'Elegante', background: 'linear-gradient(135deg, #5A2D82 0%, #825CD0 100%)', backgroundUrl: '' },
            'model-modern': { name: 'Moderno', background: 'linear-gradient(135deg, #00BFFF 0%, #1E90FF 100%)', backgroundUrl: '' },
            'model-marble': { name: 'Mrmol', background: '', backgroundUrl: 'https://placehold.co/600x400/C0C0C0/000000?text=Marble' },
            'model-gold': { name: 'Oro', background: '', backgroundUrl: 'https://placehold.co/600x400/FFD700/000000?text=Gold' }
        };

        // Populate model dropdowns
        function populateModelDropdowns() {
            const couponModelSelect = document.getElementById('couponCardModel');
            const modifyCouponModelSelect = document.getElementById('modifyCouponCardModel');
            const giftModelSelect = document.getElementById('giftCardModel');

            // Clear existing options
            couponModelSelect.innerHTML = '';
            modifyCouponModelSelect.innerHTML = '';
            giftModelSelect.innerHTML = '';

            for (const key in couponCardModels) {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = couponCardModels[key].name;
                couponModelSelect.appendChild(option);

                const modifyOption = document.createElement('option');
                modifyOption.value = key;
                modifyOption.textContent = couponCardModels[key].name;
                modifyCouponModelSelect.appendChild(modifyOption);
            }

            for (const key in giftCardModels) {
                const option = document.createElement('option');
                option.value = key;
                option.textContent = giftCardModels[key].name;
                giftModelSelect.appendChild(option);
            }
        }


        // Coupon Card Management
        let couponCards = JSON.parse(localStorage.getItem('couponCards')) || [];
        let currentCouponCardPreview = null; // Holds the data for the card currently displayed in the preview

        function saveCouponCards() {
            localStorage.setItem('couponCards', JSON.stringify(couponCards));
        }

        function generateCouponCard() {
            const recipientInput = document.getElementById('couponRecipientInput');
            const couponCardModelSelect = document.getElementById('couponCardModel');
            const couponCircleCountInput = document.getElementById('couponCircleCount');
            const couponBgColorInput = document.getElementById('couponBgColor');
            const couponTextColorInput = document.getElementById('couponTextColor');
            const couponFontFamilySelect = document.getElementById('couponFontFamily');
            const couponBgImageUploadInput = document.getElementById('couponBgImageUpload');

            const recipient = recipientInput.value.trim();
            const model = couponCardModelSelect.value;
            const circleCount = parseInt(couponCircleCountInput.value);
            const bgColor = couponBgColorInput.value;
            const textColor = couponTextColorInput.value;
            const fontFamily = couponFontFamilySelect.value;
            let bgImageUrl = '';

            if (!recipient) {
                showNotification('Por favor, ingresa el nombre del destinatario.');
                return;
            }
            if (isNaN(circleCount) || circleCount < 1 || circleCount > 10) {
                showNotification('El nmero de crculos debe estar entre 1 y 10.');
                return;
            }

            // Handle image upload
            if (couponBgImageUploadInput.files && couponBgImageUploadInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    bgImageUrl = e.target.result;
                    createAndSaveCouponCard(recipient, model, circleCount, bgColor, textColor, fontFamily, bgImageUrl);
                };
                reader.readAsDataURL(couponBgImageUploadInput.files[0]);
            } else {
                createAndSaveCouponCard(recipient, model, circleCount, bgColor, textColor, fontFamily, bgImageUrl);
            }
        }

        function createAndSaveCouponCard(recipient, model, circleCount, bgColor, textColor, fontFamily, bgImageUrl) {
            const cardNumber = generateUUID().slice(0, 14).replace(/-/g, '').match(/.{1,4}/g).join('-');
            const newCard = {
                id: generateUUID(),
                number: cardNumber,
                recipient: recipient,
                purchases: [], // Stores ISO date strings
                status: 'active',
                createdAt: new Date().toISOString(),
                redeemedAt: null,
                model: model, // Store the selected model
                circleCount: circleCount, // Store the number of circles
                bgColor: bgColor,
                textColor: textColor,
                fontFamily: fontFamily,
                bgImageUrl: bgImageUrl // Store the base64 image data
            };

            couponCards.push(newCard);
            saveCouponCards();
            updateCouponCardPreview(newCard);
            updateCouponHistory();
            document.getElementById('couponRecipientInput').value = '';
            document.getElementById('couponCircleCount').value = 10; // Reset to default
            document.getElementById('couponBgColor').value = '#FF7F50'; // Reset to default
            document.getElementById('couponTextColor').value = '#ffffff'; // Reset to default
            document.getElementById('couponFontFamily').value = 'Inter, sans-serif'; // Reset to default
            document.getElementById('couponBgImageUpload').value = ''; // Clear file input
            showNotification('Cuponera creada exitosamente.');
        }


        function updateCouponCardPreview(card) {
            const couponCardElement = document.getElementById('couponCard');
            const cardFront = couponCardElement.querySelector('.card-front');
            
            // Clear previous styles to ensure new ones apply correctly
            cardFront.style.background = '';
            cardFront.style.backgroundImage = '';
            cardFront.style.backgroundColor = '';
            cardFront.style.color = '';
            cardFront.style.fontFamily = '';

            // Apply custom styles first
            if (card.bgImageUrl) {
                cardFront.style.backgroundImage = `url('${card.bgImageUrl}')`;
                cardFront.style.backgroundSize = 'cover';
                cardFront.style.backgroundPosition = 'center';
            } else if (card.bgColor) {
                cardFront.style.backgroundColor = card.bgColor;
            } else {
                // Fallback to model's background if no custom color or image
                const selectedModel = couponCardModels[card.model] || couponCardModels['model-classic'];
                if (selectedModel.backgroundUrl) {
                    cardFront.style.backgroundImage = `url('${selectedModel.backgroundUrl}')`;
                    cardFront.style.backgroundSize = 'cover';
                    cardFront.style.backgroundPosition = 'center';
                } else {
                    cardFront.style.background = selectedModel.background;
                }
            }

            cardFront.style.color = card.textColor || 'white';
            cardFront.style.fontFamily = card.fontFamily || 'Inter, sans-serif';

            document.getElementById('couponCardNumber').textContent = card.number;
            document.getElementById('couponRecipientName').textContent = card.recipient.toUpperCase();

            // Dynamically create circles
            const circlesContainer = document.getElementById('couponPurchaseCircles');
            circlesContainer.innerHTML = ''; // Clear existing circles
            for (let i = 1; i <= card.circleCount; i++) {
                const circle = document.createElement('div');
                circle.classList.add('circle');
                circle.textContent = i;
                if (i <= card.purchases.length) {
                    circle.classList.add('filled');
                }
                circlesContainer.appendChild(circle);
            }

            const canjeIndicator = document.getElementById('couponCanjeIndicator');
            const purchaseCount = card.purchases.length;
            if (card.status === 'active' && (purchaseCount >= 5 || purchaseCount >= 8 || purchaseCount >= 10)) {
                canjeIndicator.style.display = 'block';
            } else {
                canjeIndicator.style.display = 'none';
            }
            currentCouponCardPreview = card; // Update the global preview variable
        }

        function addCouponCircle() {
            if (!currentCouponCardPreview) {
                showNotification('Por favor, selecciona o crea una cuponera primero.');
                return;
            }
            if (currentCouponCardPreview.circleCount < 10) {
                currentCouponCardPreview.circleCount++;
                saveCouponCards(); // Save the updated card
                updateCouponCardPreview(currentCouponCardPreview); // Update the preview
                updateCouponHistory(); // Update the history table
                showNotification('Crculo aadido.');
            } else {
                showNotification('Mximo de 10 crculos alcanzado.');
            }
        }

        function removeCouponCircle() {
            if (!currentCouponCardPreview) {
                showNotification('Por favor, selecciona o crea una cuponera primero.');
                return;
            }
            if (currentCouponCardPreview.circleCount > 1) {
                currentCouponCardPreview.circleCount--;
                // If reducing circles below current purchases, remove excess purchases
                if (currentCouponCardPreview.purchases.length > currentCouponCardPreview.circleCount) {
                    currentCouponCardPreview.purchases.pop(); // Remove the last purchase
                }
                saveCouponCards(); // Save the updated card
                updateCouponCardPreview(currentCouponCardPreview); // Update the preview
                updateCouponHistory(); // Update the history table
                showNotification('Crculo eliminado.');
            } else {
                showNotification('Mnimo de 1 crculo.');
            }
        }

        function updateCouponHistory() {
            const tbody = document.getElementById('couponHistoryBody');
            tbody.innerHTML = '';
            const filteredCards = filterCouponCards();
            if (filteredCards.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" class="no-records">No hay cuponeras registradas</td></tr>';
                return;
            }

            filteredCards.forEach(card => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${card.number}</td>
                    <td>${card.recipient}</td>
                    <td>${card.purchases.length}/${card.circleCount}</td>
                    <td>${card.circleCount}</td>
                    <td>${formatDate(new Date(card.createdAt))}</td>
                    <td><span class="status ${card.status}">${card.status === 'active' ? 'Activa' : 'Canjeada'}</span></td>
                    <td>${card.redeemedAt ? formatDate(new Date(card.redeemedAt)) : '-'}</td>
                    <td class="action-buttons">
                        <button class="action-btn btn-primary" onclick="showModal('registerPurchaseModal'); document.getElementById('purchaseCardNumber').value = '${card.number}'">Registrar Compra</button>
                        <button class="action-btn btn-warning" onclick="showModal('redeemCouponModal'); document.getElementById('redeemCardNumber').value = '${card.number}'">Canjear</button>
                        <button class="action-btn btn-secondary" onclick="editCouponCard('${card.id}')">Modificar</button>
                        <button class="action-btn btn-info" onclick="managePurchases('${card.id}')">Gestionar Compras</button>
                        <button class="action-btn btn-danger" onclick="deleteCouponCard('${card.id}')">Eliminar</button>
                    </td>
                `;
                row.onclick = () => updateCouponCardPreview(card); // Add click event to row
                tbody.appendChild(row);
            });
        }

        function filterCouponCards() {
            const searchInput = document.getElementById('couponSearchInput').value.toLowerCase();
            const statusFilter = document.getElementById('couponStatusFilter').value;

            return couponCards.filter(card => {
                const matchesSearch = !searchInput ||
                    card.recipient.toLowerCase().includes(searchInput) ||
                    card.number.toLowerCase().includes(searchInput);
                const matchesStatus = !statusFilter || card.status === statusFilter;
                return matchesSearch && matchesStatus;
            });
        }

        function filterCouponHistory() {
            updateCouponHistory();
        }

        function registerPurchase() {
            const cardNumber = document.getElementById('purchaseCardNumber').value.trim();
            const purchaseDateInput = document.getElementById('purchaseDate').value;
            if (!cardNumber || !purchaseDateInput) {
                showNotification('Por favor, completa todos los campos.');
                return;
            }

            const purchaseDate = new Date(purchaseDateInput);
            const today = new Date();
            today.setHours(0, 0, 0, 0); // Normalize today's date to midnight
            purchaseDate.setHours(0, 0, 0, 0); // Normalize purchase date to midnight

            if (purchaseDate > today) {
                showNotification('La fecha de compra no puede ser futura.');
                return;
            }

            const card = couponCards.find(c => c.number === cardNumber && c.status === 'active');
            if (!card) {
                showNotification('Cuponera no encontrada o ya canjeada.');
                return;
            }

            if (card.purchases.length >= card.circleCount) {
                showNotification(`La cuponera ya tiene el mximo de compras (${card.circleCount}).`);
                return;
            }

            // Check if a purchase already exists for this date
            const existingPurchase = card.purchases.find(p => {
                const pDate = new Date(p);
                pDate.setHours(0, 0, 0, 0);
                return pDate.getTime() === purchaseDate.getTime();
            });

            if (existingPurchase) {
                showNotification('Ya se registr una compra en esta fecha para esta cuponera.');
                return;
            }

            card.purchases.push(purchaseDate.toISOString()); // Store as ISO string
            saveCouponCards();
            updateCouponCardPreview(card);
            updateCouponHistory();
            closeModal('registerPurchaseModal');
            showNotification('Compra registrada exitosamente.');
        }

        function redeemCouponCard() {
            const cardNumber = document.getElementById('redeemCardNumber').value.trim();
            const card = couponCards.find(c => c.number === cardNumber && c.status === 'active');
            if (!card) {
                showNotification('Cuponera no encontrada o ya canjeada.');
                return;
            }

            const purchaseCount = card.purchases.length;
            let discount = 0;
            if (purchaseCount >= 5) discount = 40;
            if (purchaseCount >= 8) discount = 75;
            if (purchaseCount >= 10) discount = 100;

            if (discount === 0) {
                showNotification('La cuponera no tiene suficientes compras para canjear.');
                return;
            }

            showConfirmationModal(`Ests seguro de que deseas canjear esta cuponera por un ${discount}% de descuento? Esto la invalidar.`, (confirmed) => {
                if (confirmed) {
                    card.status = 'redeemed';
                    card.redeemedAt = new Date().toISOString();
                    saveCouponCards();
                    updateCouponHistory();
                    closeModal('redeemCouponModal');
                    showNotification(`Cuponera canjeada: ${discount}% de descuento aplicado.`);
                    // Update preview if this was the current card
                    if (currentCouponCardPreview && currentCouponCardPreview.id === card.id) {
                        updateCouponCardPreview(card);
                    }
                }
            });
        }

        function applyCouponCard() {
            const cardNumber = document.getElementById('couponCardInput').value.trim();
            const card = couponCards.find(c => c.number === cardNumber && c.status === 'active');
            if (!card) {
                showNotification('Cuponera no encontrada o ya canjeada.');
                return;
            }

            const purchaseCount = card.purchases.length;
            let discountPercentage = 0;
            if (purchaseCount >= 5) discountPercentage = 40;
            if (purchaseCount >= 8) discountPercentage = 75;
            if (purchaseCount >= 10) discountPercentage = 100;

            if (discountPercentage === 0) {
                showNotification('La cuponera no tiene suficientes compras para aplicar descuento.');
                return;
            }

            // Apply discount logic to cart (simplified for demo)
            const cartTotalElement = document.getElementById('cartTotal');
            const cartSubtotalElement = document.getElementById('cartSubtotal');
            const cartDiscountElement = document.getElementById('cartDiscount');

            let currentSubtotal = parseFloat(cartSubtotalElement.textContent.replace('$', '')) || 0;
            let appliedDiscount = currentSubtotal * (discountPercentage / 100);
            let finalTotal = currentSubtotal - appliedDiscount;

            cartDiscountElement.textContent = `-$${appliedDiscount.toFixed(2)}`;
            cartTotalElement.textContent = `$${finalTotal.toFixed(2)}`;
            showNotification(`Descuento de ${discountPercentage}% aplicado al carrito.`);
            
            // Optionally, mark the card as redeemed here if the discount is applied to a final checkout
            // For this demo, we'll keep it separate for "redeem" action in the management section.
        }

        function printCouponCard() {
            // Use the currently displayed coupon card for printing
            let cardToPrint = currentCouponCardPreview;

            if (!cardToPrint) {
                showNotification('No hay una cuponera seleccionada o creada para imprimir.');
                return;
            }
            
            // Temporarily update the preview with the card to be printed
            updateCouponCardPreview(cardToPrint);

            const couponCardElement = document.getElementById('couponCard');
            const printArea = document.getElementById('print-area');
            const clonedCard = couponCardElement.cloneNode(true); // Clone the entire card

            // Ensure the cloned card is in its front-facing state for printing
            clonedCard.style.transform = 'none';
            const cardBack = clonedCard.querySelector('.card-back');
            if (cardBack) {
                cardBack.style.display = 'none'; // Hide the back
            }

            printArea.innerHTML = ''; // Clear previous content
            printArea.appendChild(clonedCard); // Add the cloned card to the print area

            window.print(); // Trigger print dialog

            // Clean up the print area after printing (optional, but good practice)
            setTimeout(() => {
                printArea.innerHTML = '';
            }, 1000); // Give some time for print dialog to appear
        }

        function editCouponCard(cardId) {
            const card = couponCards.find(c => c.id === cardId);
            if (card) {
                document.getElementById('modifyCouponId').value = card.id;
                document.getElementById('modifyCouponRecipientName').value = card.recipient;
                document.getElementById('modifyCouponCardModel').value = card.model || 'model-classic'; // Set current model
                document.getElementById('modifyCouponCircleCount').value = card.circleCount || 10; // Set current circle count
                document.getElementById('modifyCouponBgColor').value = card.bgColor || '#FF7F50';
                document.getElementById('modifyCouponTextColor').value = card.textColor || '#ffffff';
                document.getElementById('modifyCouponFontFamily').value = card.fontFamily || 'Inter, sans-serif';
                // Note: File input cannot be programmatically set for security reasons.
                // The user will need to re-upload if they want a new image.
                showModal('modifyCouponModal');
            } else {
                showNotification('Cuponera no encontrada.');
            }
        }

        function saveModifiedCouponCard() {
            const cardId = document.getElementById('modifyCouponId').value;
            const newRecipientName = document.getElementById('modifyCouponRecipientName').value.trim();
            const newModel = document.getElementById('modifyCouponCardModel').value;
            const newCircleCount = parseInt(document.getElementById('modifyCouponCircleCount').value);
            const newBgColor = document.getElementById('modifyCouponBgColor').value;
            const newTextColor = document.getElementById('modifyCouponTextColor').value;
            const newFontFamily = document.getElementById('modifyCouponFontFamily').value;
            const newBgImageUploadInput = document.getElementById('modifyCouponBgImageUpload');
            let newBgImageUrl = '';

            if (!newRecipientName) {
                showNotification('El nombre del destinatario no puede estar vaco.');
                return;
            }
            if (isNaN(newCircleCount) || newCircleCount < 1 || newCircleCount > 10) {
                showNotification('El nmero de crculos debe estar entre 1 y 10.');
                return;
            }

            const cardIndex = couponCards.findIndex(c => c.id === cardId);
            if (cardIndex === -1) {
                showNotification('Error al modificar la cuponera.');
                return;
            }

            const currentCard = couponCards[cardIndex];

            // Handle image upload for modification
            if (newBgImageUploadInput.files && newBgImageUploadInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    newBgImageUrl = e.target.result;
                    updateAndSaveCouponCard(currentCard, newRecipientName, newModel, newCircleCount, newBgColor, newTextColor, newFontFamily, newBgImageUrl);
                };
                reader.readAsDataURL(newBgImageUploadInput.files[0]);
            } else {
                // If no new image is uploaded, retain the existing one
                newBgImageUrl = currentCard.bgImageUrl || '';
                updateAndSaveCouponCard(currentCard, newRecipientName, newModel, newCircleCount, newBgColor, newTextColor, newFontFamily, newBgImageUrl);
            }
        }

        function updateAndSaveCouponCard(card, newRecipientName, newModel, newCircleCount, newBgColor, newTextColor, newFontFamily, newBgImageUrl) {
            card.recipient = newRecipientName;
            card.model = newModel;
            card.circleCount = newCircleCount;
            card.bgColor = newBgColor;
            card.textColor = newTextColor;
            card.fontFamily = newFontFamily;
            card.bgImageUrl = newBgImageUrl;

            // Adjust purchases if circle count is reduced
            if (card.purchases.length > newCircleCount) {
                card.purchases = card.purchases.slice(0, newCircleCount);
            }
            saveCouponCards();
            updateCouponHistory();
            closeModal('modifyCouponModal');
            showNotification('Cuponera modificada exitosamente.');
            // Update preview if this was the current card
            if (currentCouponCardPreview && currentCouponCardPreview.id === card.id) {
                updateCouponCardPreview(card);
            }
        }


        function deleteCouponCard(cardId) {
            showConfirmationModal('Ests seguro de que deseas eliminar esta cuponera? Esta accin no se puede deshacer.', (confirmed) => {
                if (confirmed) {
                    couponCards = couponCards.filter(c => c.id !== cardId);
                    saveCouponCards();
                    updateCouponHistory();
                    showNotification('Cuponera eliminada.');
                    // If the deleted card was in preview, reset preview
                    if (currentCouponCardPreview && currentCouponCardPreview.id === cardId) {
                        if (couponCards.length > 0) {
                            updateCouponCardPreview(couponCards[couponCards.length - 1]);
                        } else {
                            updateCouponCardPreview({
                                number: 'XXXX-XXXX-XXXX',
                                recipient: 'NOMBRE DEL DESTINATARIO',
                                purchases: [],
                                model: 'model-classic',
                                circleCount: 10,
                                bgColor: '#FF7F50',
                                textColor: '#ffffff',
                                fontFamily: 'Inter, sans-serif',
                                bgImageUrl: ''
                            });
                        }
                    }
                }
            });
        }

        function managePurchases(cardId) {
            const card = couponCards.find(c => c.id === cardId);
            if (!card) {
                showNotification('Cuponera no encontrada.');
                return;
            }

            document.getElementById('managePurchasesCouponId').value = card.id;
            document.getElementById('managePurchasesCardNumber').textContent = card.number;
            const purchaseList = document.getElementById('purchaseList');
            purchaseList.innerHTML = ''; // Clear previous list

            if (card.purchases.length === 0) {
                purchaseList.innerHTML = '<p style="text-align: center; color: #666;">No hay compras registradas para esta cuponera.</p>';
            } else {
                card.purchases.sort((a, b) => new Date(a) - new Date(b)); // Sort by date
                card.purchases.forEach((purchaseDateISO, index) => {
                    const date = new Date(purchaseDateISO);
                    const listItem = document.createElement('div');
                    listItem.style.display = 'flex';
                    listItem.style.justifyContent = 'space-between';
                    listItem.style.alignItems = 'center';
                    listItem.style.padding = '8px 0';
                    listItem.style.borderBottom = '1px dashed #eee';
                    listItem.innerHTML = `
                        <span>Compra ${index + 1}: ${formatDate(date)}</span>
                        <button class="action-btn btn-danger" onclick="removePurchase('${card.id}', '${purchaseDateISO}')">Eliminar</button>
                    `;
                    purchaseList.appendChild(listItem);
                });
            }
            showModal('managePurchasesModal');
        }

        function removePurchase(cardId, purchaseDateISO) {
            showConfirmationModal('Ests seguro de que deseas eliminar esta compra?', (confirmed) => {
                if (confirmed) {
                    const card = couponCards.find(c => c.id === cardId);
                    if (card) {
                        card.purchases = card.purchases.filter(p => p !== purchaseDateISO);
                        saveCouponCards();
                        updateCouponHistory();
                        managePurchases(cardId); // Refresh the list in the modal
                        showNotification('Compra eliminada exitosamente.');
                        // Update preview if this was the current card
                        if (currentCouponCardPreview && currentCouponCardPreview.id === card.id) {
                            updateCouponCardPreview(card);
                        }
                    }
                }
            });
        }


        // Initialize Coupon Card Section
        function initCouponCardSection() {
            if (couponCards.length > 0) {
                updateCouponCardPreview(couponCards[couponCards.length - 1]);
            } else {
                // Set default preview if no cards exist
                updateCouponCardPreview({
                    number: 'XXXX-XXXX-XXXX',
                    recipient: 'NOMBRE DEL DESTINATARIO',
                    purchases: [],
                    model: 'model-classic',
                    circleCount: 10,
                    bgColor: '#FF7F50',
                    textColor: '#ffffff',
                    fontFamily: 'Inter, sans-serif',
                    bgImageUrl: ''
                });
            }
            updateCouponHistory();
        }

        // Cart Functions
        let cart = JSON.parse(localStorage.getItem('cart')) || [];

        function toggleCart() {
            showModal('cartModal');
            updateCart();
        }

        function updateCart() {
            const cartItems = document.getElementById('cartItems');
            const cartSummary = document.getElementById('cartSummary');
            const emptyCartMessage = document.getElementById('emptyCartMessage');
            const cartCount = document.getElementById('cartCount');
            cartItems.innerHTML = '';

            if (cart.length === 0) {
                emptyCartMessage.style.display = 'block';
                cartSummary.style.display = 'none';
                cartCount.textContent = '0';
                return;
            }

            emptyCartMessage.style.display = 'none';
            cartSummary.style.display = 'block';

            let subtotal = 0;
            cart.forEach((item, index) => {
                const price = item.offerPrice || item.regularPrice;
                const itemTotal = price * item.quantity;
                subtotal += itemTotal;
                const cartItem = document.createElement('div');
                cartItem.classList.add('cart-item');
                cartItem.innerHTML = `
                    <img src="${item.image}" alt="${item.name}">
                    <div class="cart-item-info">
                        <div class="cart-item-name">${item.name}</div>
                        <div class="cart-item-price">$${itemTotal.toFixed(2)}</div>
                        <div class="quantity-controls">
                            <button class="quantity-btn" onclick="updateQuantity(${index}, -1)">-</button>
                            <span>${item.quantity}</span>
                            <button class="quantity-btn" onclick="updateQuantity(${index}, 1)">+</button>
                        </div>
                        <button class="remove-item" onclick="removeFromCart(${index})">Eliminar</button>
                    </div>
                `;
                cartItems.appendChild(cartItem);
            });

            document.getElementById('cartSubtotal').textContent = `$${subtotal.toFixed(2)}`;
            document.getElementById('cartDiscount').textContent = '$0.00'; // Reset discount on cart update
            document.getElementById('cartTotal').textContent = `$${subtotal.toFixed(2)}`;
            cartCount.textContent = cart.reduce((sum, item) => sum + item.quantity, 0);
        }

        function updateQuantity(index, change) {
            cart[index].quantity += change;
            if (cart[index].quantity <= 0) {
                cart.splice(index, 1);
            }
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCart();
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCart();
        }

        function openCheckoutInfoModal() {
            showModal('checkoutInfoModal');
        }

        // Auction Functions
        let auctions = JSON.parse(localStorage.getItem('auctions')) || [];

        function createAuction() {
            const productName = document.getElementById('auctionProductName').value.trim();
            const basePrice = parseFloat(document.getElementById('auctionBasePrice').value);
            const durationElement = document.querySelector('#auctionDuration .time-option.selected');
            const duration = durationElement ? parseInt(durationElement.dataset.value) : 24;

            if (!productName || isNaN(basePrice)) {
                showNotification('Por favor, completa todos los campos.');
                return;
            }

            const auction = {
                id: generateUUID(),
                name: productName,
                basePrice: basePrice,
                currentBid: basePrice,
                endTime: new Date(Date.now() + duration * 60 * 60 * 1000).toISOString(),
                image: 'https://placehold.co/300x250?text=Auction+Product',
                status: 'active'
            };

            auctions.push(auction);
            localStorage.setItem('auctions', JSON.stringify(auctions));
            updateAuctionGrid();
            closeModal('auctionModal');
            showNotification('Subasta creada exitosamente.');
        }

        function updateAuctionGrid() {
            const auctionGrid = document.getElementById('auctionGrid');
            auctionGrid.innerHTML = '';
            auctions.forEach(auction => {
                if (auction.status === 'active') {
                    const card = document.createElement('div');
                    card.classList.add('product-card');
                    card.innerHTML = `
                        <div class="product-image">
                            <img src="${auction.image}" alt="${auction.name}">
                            <span class="auction-badge">Subasta</span>
                        </div>
                        <div class="auction-info">
                            <div class="product-name">${auction.name}</div>
                            <div class="auction-current-bid">Puja actual: $${auction.currentBid.toFixed(2)}</div>
                            <div class="auction-timer" id="auctionTimer_${auction.id}"></div>
                            <div class="bid-input">
                                <input type="number" placeholder="Tu puja" min="${auction.currentBid + 1}">
                                <button class="bid-btn" onclick="placeBid('${auction.id}', this)">Pujar</button>
                            </div>
                        </div>
                    `;
                    auctionGrid.appendChild(card);
                    updateAuctionTimer(auction);
                }
            });
        }

        function updateAuctionTimer(auction) {
            const timerElement = document.getElementById(`auctionTimer_${auction.id}`);
            if (!timerElement) return; // Guard against element not existing

            const update = () => {
                const now = new Date();
                const end = new Date(auction.endTime);
                const diff = end - now;
                if (diff <= 0) {
                    auction.status = 'ended';
                    localStorage.setItem('auctions', JSON.stringify(auctions));
                    updateAuctionGrid();
                    timerElement.textContent = 'Subasta terminada.';
                    return;
                }
                const hours = Math.floor(diff / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                timerElement.textContent = `Tiempo restante: ${hours}h ${minutes}m ${seconds}s`;
                setTimeout(update, 1000);
            };
            update();
        }

        function placeBid(auctionId, button) {
            const auction = auctions.find(a => a.id === auctionId);
            if (!auction || auction.status !== 'active') {
                showNotification('Esta subasta no est activa.');
                return;
            }
            const input = button.previousElementSibling;
            const bid = parseFloat(input.value);
            if (isNaN(bid) || bid <= auction.currentBid) {
                showNotification('La puja debe ser mayor que la actual.');
                return;
            }
            auction.currentBid = bid;
            localStorage.setItem('auctions', JSON.stringify(auctions));
            updateAuctionGrid();
            showNotification('Puja realizada exitosamente.');
        }

        // Navigation and Sections
        function showSection(sectionId, element) {
            document.querySelectorAll('section').forEach(section => {
                section.style.display = 'none';
            });
            document.getElementById(`${sectionId}Section`).style.display = 'block';
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active-nav');
            });
            if (element) element.classList.add('active-nav');
            if (sectionId === 'couponCardManagement') {
                initCouponCardSection();
            }
            // Ensure gift card preview is updated when navigating to its section
            if (sectionId === 'giftCardManagement') {
                if (giftCards.length > 0) {
                    updateGiftCardPreview(giftCards[giftCards.length - 1]);
                } else {
                    // Set default preview if no cards exist
                    updateGiftCardPreview({
                        cardNumber: 'XXXX-XXXX-XXXX',
                        recipientName: 'NOMBRE DEL DESTINATARIO',
                        amount: 0,
                        model: 'model-classic',
                        bgColor: '#ff6b6b',
                        textColor: '#ffffff',
                        fontFamily: 'Inter, sans-serif',
                        bgImageUrl: ''
                    });
                }
                updateHistoryTable(); // Refresh history table
            }
        }

        // Cargar catlogo en tiempo real
        async function cargarCatalogo() {
            const grid = document.getElementById('productGrid');
            grid.innerHTML = '<p class="col-span-full text-center text-xl">Cargando catlogo en tiempo real...</p>';

            try {
                const doc = await db.collection('catalogo_publico').doc('showroom_roma').get();
                if (!doc.exists) {
                    grid.innerHTML = '<p class="col-span-full text-center text-xl">Catlogo vaco<br><small>Sub prendas en etiquetaqr.online</small></p>';
                    return;
                }

                const productos = doc.data().productos || [];
                grid.innerHTML = '';

                if (productos.length === 0) {
                    grid.innerHTML = '<p class="col-span-full text-center text-xl">No hay productos en stock</p>';
                    return;
                }

                productos.forEach(p => {
                    const card = document.createElement('div');
                    card.className = 'product-card';
                    card.innerHTML = `
                        <div class="product-image">
                            <img src="${p.image}" alt="${p.name}" loading="lazy">
                            <span class="offer-badge">En stock</span>
                        </div>
                        <div class="product-info">
                            <div class="product-name">${p.name}</div>
                            ${p.talle ? `<p class="text-sm text-gray-600">Talle: ${p.talle}</p>` : ''}
                            ${p.vendedora ? `<p class="text-xs text-gray-500">Vendedora: ${p.vendedora}</p>` : ''}
                            <div class="product-prices">
                                <span class="price-original">$${p.regularPrice.toFixed(2)}</span>
                                <span class="price-offer">$${p.offerPrice.toFixed(2)}</span>
                            </div>
                            <div class="product-actions">
                                <button class="btn btn-primary" onclick="addToCart(${JSON.stringify(p).replace(/"/g, '&quot;')})">
                                    Agregar al Carrito
                                </button>
                            </div>
                        </div>
                    `;
                    grid.appendChild(card);
                });
            } catch (e) {
                console.error(e);
                grid.innerHTML = '<p class="col-span-full text-center text-red-500">Error de conexin</p>';
            }
        }

        // Actualizacin en tiempo real
        db.collection('catalogo_publico').doc('showroom_roma')
          .onSnapshot(() => cargarCatalogo());

        // Al cargar la pgina
        window.addEventListener('load', () => {
            setTimeout(() => document.getElementById('loadingScreen').classList.add('hidden'), 3000);
            cargarCatalogo();
        });
        // Carousel Functions
        let currentSlide = 0;
        const slides = document.querySelectorAll('.carousel-slide');
        const totalSlides = slides.length;

        function updateCarousel() {
            const carousel = document.getElementById('carousel');
            carousel.style.transform = `translateX(-${currentSlide * 100}%)`;
        }

        function nextSlide() {
            currentSlide = (currentSlide + 1) % totalSlides;
            updateCarousel();
        }

        function prevSlide() {
            currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
            updateCarousel();
        }

        setInterval(nextSlide, 5000);

        // Product Detail Carousel
        let currentProductSlide = 0;

        function updateProductCarousel(product) {
            const carousel = document.getElementById('productDetailCarousel');
            carousel.style.transform = `translateX(-${currentProductSlide * 100}%)`;
        }

        function nextProductSlide() {
            const product = products.find(p => p.id === currentProductId);
            currentProductSlide = (currentProductSlide + 1) % product.images.length;
            updateProductCarousel(product);
        }

        function prevProductSlide() {
            const product = products.find(p => p.id === currentProductId);
            currentProductSlide = (currentProductSlide - 1 + product.images.length) % product.images.length;
            updateProductCarousel(product);
        }

        // Sample Products
        const products = [
            {
                id: '1',
                name: 'Zapatillas Nike Air Max',
                listPrice: 200,
                offerPrice: 150,
                regularPrice: 180,
                discount: 25,
                images: ['https://placehold.co/300x250?text=Nike+Air+Max+1', 'https://placehold.co/300x250?text=Nike+Air+Max+2'],
                description: 'Zapatillas importadas con tecnologa Air para mxima comodidad.'
            },
            {
                id: '2',
                name: 'Zapatillas Adidas Ultraboost',
                regularPrice: 220,
                images: ['https://placehold.co/300x250?text=Adidas+Ultraboost'],
                description: 'Diseo ergonmico para un rendimiento superior.'
            }
        ];

        let currentProductId = null;

        function showProductDetail(productId) {
            const product = products.find(p => p.id === productId);
            currentProductId = productId;
            document.getElementById('productDetailName').textContent = product.name;
            document.getElementById('productDetailDescription').textContent = product.description;
            document.getElementById('productDetailListPrice').style.display = product.listPrice ? 'block' : 'none';
            document.getElementById('productDetailListPrice').textContent = product.listPrice ? `$${product.listPrice.toFixed(2)}` : '';
            document.getElementById('productDetailOfferPrice').style.display = product.offerPrice ? 'block' : 'none';
            document.getElementById('productDetailOfferPrice').textContent = product.offerPrice ? `$${product.offerPrice.toFixed(2)}` : '';
            document.getElementById('productDetailRegularPrice').style.display = product.regularPrice ? 'block' : 'none';
            document.getElementById('productDetailRegularPrice').textContent = product.regularPrice ? `$${product.regularPrice.toFixed(2)}` : '';
            document.getElementById('productDetailDiscount').style.display = product.discount ? 'block' : 'none';
            document.getElementById('productDetailDiscount').textContent = product.discount ? `${product.discount}% OFF` : '';
            document.getElementById('productDetailCarousel').innerHTML = product.images.map(img => `<div class="carousel-slide" style="background-image: url('${img}')"></div>`).join('');
            currentProductSlide = 0;
            updateProductCarousel(product);
            document.getElementById('productDetailAddToCart').onclick = () => addToCart(product);
            showSection('productDetail', null);
        }

        function addToCart(product) {
            const existingItem = cart.find(item => item.id === product.id);
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ ...product, quantity: 1 });
            }
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCart();
            showNotification('Producto aadido al carrito.');
        }

        // Initialize Product Grid
        function initProductGrid() {
            const productGrid = document.getElementById('productGrid');
            productGrid.innerHTML = '';
            products.forEach(product => {
                const card = document.createElement('div');
                card.classList.add('product-card');
                card.innerHTML = `
                    <div class="product-image">
                        <img src="${product.images[0]}" alt="${product.name}">
                        ${product.offerPrice ? '<span class="offer-badge">Oferta</span>' : ''}
                    </div>
                    <div class="product-info">
                        <div class="product-name">${product.name}</div>
                        <div class="product-prices">
                            ${product.listPrice ? `<span class="price-original">$${product.listPrice.toFixed(2)}</span>` : ''}
                            ${product.offerPrice ? `<span class="price-offer">$${product.offerPrice.toFixed(2)}</span>` : ''}
                            ${!product.offerPrice ? `<span class="price-regular">$${product.regularPrice.toFixed(2)}</span>` : ''}
                        </div>
                        ${product.offerPrice ? `<div class="offer-timer">Oferta termina en: 24h</div>` : ''}
                        <div class="product-actions">
                            <button class="btn btn-primary" onclick="addToCart(products[${products.indexOf(product)}])">Agregar al Carrito</button>
                            <button class="btn btn-secondary" onclick="showProductDetail('${product.id}')">Ver Detalle</button>
                        </div>
                    </div>
                `;
                productGrid.appendChild(card);
            });
        }

        // User Menu (Placeholder)
        function toggleUserMenu() {
            showNotification('Funcionalidad de usuario no implementada.');
        }

        // Loading Screen
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.getElementById('loadingScreen').classList.add('hidden');
            }, 3000);
            initProductGrid();
            updateAuctionGrid();
            populateModelDropdowns(); // Populate dropdowns on load
            initCouponCardSection();
            loadGiftCards(); // Load gift cards and update preview
        });

        // Gift Card Functions (integrated and improved)
        let giftCards = JSON.parse(localStorage.getItem('giftCards')) || [];
        let currentGiftCardPreview = null; // This will hold the currently displayed gift card data

        function saveGiftCards() {
            localStorage.setItem('giftCards', JSON.stringify(giftCards));
            console.log('Gift cards saved to localStorage:', giftCards);
        }

        function generateRandomCardNumber() {
            const segments = [];
            for (let i = 0; i < 3; i++) {
                segments.push(Math.floor(Math.random() * 10000).toString().padStart(4, '0'));
            }
            return segments.join('-');
        }

        function generateGiftCard() {
            const recipientName = document.getElementById('recipientInput').value.trim();
            const amount = document.getElementById('amountInput').value;
            const giftCardModelSelect = document.getElementById('giftCardModel');
            const giftCardBgColorInput = document.getElementById('giftCardBgColor');
            const giftCardTextColorInput = document.getElementById('giftCardTextColor');
            const giftCardFontFamilySelect = document.getElementById('giftCardFontFamily');
            const giftCardBgImageUploadInput = document.getElementById('giftCardBgImageUpload');

            const model = giftCardModelSelect.value;
            const bgColor = giftCardBgColorInput.value;
            const textColor = giftCardTextColorInput.value;
            const fontFamily = giftCardFontFamilySelect.value;
            let bgImageUrl = '';
            
            if (!recipientName || !amount) {
                showNotification('Por favor completa todos los campos de la Gift Card.');
                return;
            }

            const parsedAmount = parseInt(amount);
            if (isNaN(parsedAmount) || parsedAmount < 0) {
                showNotification('Por favor, ingresa un monto vlido (nmero positivo).');
                return;
            }

            // Handle image upload
            if (giftCardBgImageUploadInput.files && giftCardBgImageUploadInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    bgImageUrl = e.target.result;
                    createAndSaveGiftCard(recipientName, parsedAmount, model, bgColor, textColor, fontFamily, bgImageUrl);
                };
                reader.readAsDataURL(giftCardBgImageUploadInput.files[0]);
            } else {
                createAndSaveGiftCard(recipientName, parsedAmount, model, bgColor, textColor, fontFamily, bgImageUrl);
            }
        }

        function createAndSaveGiftCard(recipientName, amount, model, bgColor, textColor, fontFamily, bgImageUrl) {
            const cardNumber = generateRandomCardNumber();
            const now = new Date();
            
            const newCard = {
                id: Date.now(),
                cardNumber: cardNumber,
                recipientName: recipientName,
                amount: amount,
                createdDate: now.toLocaleDateString(),
                status: 'active',
                usedDate: null,
                model: model, // Store the selected model
                bgColor: bgColor,
                textColor: textColor,
                fontFamily: fontFamily,
                bgImageUrl: bgImageUrl // Store the base64 image data
            };

            giftCards.push(newCard);
            saveGiftCards();
            
            // Update preview with the newly created card
            updateGiftCardPreview(newCard);
            
            currentGiftCardPreview = newCard; // Set the newly created card as the current card for printing
            
            // Limpiar formulario
            document.getElementById('recipientInput').value = '';
            document.getElementById('amountInput').value = '';
            document.getElementById('giftCardBgColor').value = '#ff6b6b'; // Reset to default
            document.getElementById('giftCardTextColor').value = '#ffffff'; // Reset to default
            document.getElementById('giftCardFontFamily').value = 'Inter, sans-serif'; // Reset to default
            document.getElementById('giftCardBgImageUpload').value = ''; // Clear file input
            
            updateHistoryTable();
            
            showNotification(`Gift Card creada exitosamente!\nNmero: ${cardNumber}\nDestinatario: ${recipientName}\nMonto: $${amount.toLocaleString()}`);
        }

        function updateGiftCardPreview(cardData) {
            const giftCardElement = document.getElementById('giftCard');
            const cardFront = giftCardElement.querySelector('.card-front');

            // Clear previous styles to ensure new ones apply correctly
            cardFront.style.background = '';
            cardFront.style.backgroundImage = '';
            cardFront.style.backgroundColor = '';
            cardFront.style.color = '';
            cardFront.style.fontFamily = '';

            // Apply custom styles first
            if (cardData.bgImageUrl) {
                cardFront.style.backgroundImage = `url('${cardData.bgImageUrl}')`;
                cardFront.style.backgroundSize = 'cover';
                cardFront.style.backgroundPosition = 'center';
            } else if (cardData.bgColor) {
                cardFront.style.backgroundColor = cardData.bgColor;
            } else {
                // Fallback to model's background if no custom color or image
                const selectedModel = giftCardModels[cardData.model] || giftCardModels['model-classic'];
                if (selectedModel.backgroundUrl) {
                    cardFront.style.backgroundImage = `url('${selectedModel.backgroundUrl}')`;
                    cardFront.style.backgroundSize = 'cover';
                    cardFront.style.backgroundPosition = 'center';
                } else {
                    cardFront.style.background = selectedModel.background;
                }
            }

            cardFront.style.color = cardData.textColor || 'white';
            cardFront.style.fontFamily = cardData.fontFamily || 'Inter, sans-serif';

            document.getElementById('cardNumber').textContent = cardData.cardNumber;
            document.getElementById('recipientName').textContent = cardData.recipientName.toUpperCase();
            document.getElementById('amount').textContent = `$${cardData.amount.toLocaleString()}`;
            
            currentGiftCardPreview = cardData; // Update the global preview variable
        }

        function printCard() {
            // If no card has been generated or selected, use the current preview values
            let cardToPrint = currentGiftCardPreview;
            if (!cardToPrint) {
                showNotification('No hay una Gift Card seleccionada o creada para imprimir.');
                return;
            }

            // Temporarily update the preview with the card to be printed
            updateGiftCardPreview(cardToPrint);

            const giftCardElement = document.getElementById('giftCard');
            const printArea = document.getElementById('print-area');
            const clonedCard = giftCardElement.cloneNode(true); // Clone the entire card

            // Ensure the cloned card is in its front-facing state for printing
            clonedCard.style.transform = 'none';
            const cardBack = clonedCard.querySelector('.card-back');
            if (cardBack) {
                cardBack.style.display = 'none'; // Hide the back
            }

            printArea.innerHTML = ''; // Clear previous content
            printArea.appendChild(clonedCard); // Add the cloned card to the print area

            window.print(); // Trigger print dialog

            // Clean up the print area after printing (optional, but good practice)
            setTimeout(() => {
                printArea.innerHTML = '';
            }, 1000); // Give some time for print dialog to appear
        }

        function markAsUsed(cardId) {
            showConfirmationModal('Ests seguro de que deseas marcar esta gift card como usada?', (confirmed) => {
                if (confirmed) {
                    const card = giftCards.find(c => c.id === cardId);
                    if (card) {
                        card.status = 'used';
                        card.usedDate = new Date().toLocaleDateString();
                        saveGiftCards();
                        updateHistoryTable();
                        showNotification('Gift card marcada como usada.');
                        if (currentGiftCardPreview && currentGiftCardPreview.id === card.id) {
                            updateGiftCardPreview(card);
                        }
                    }
                }
            });
        }

        function deleteCard(cardId) {
            showConfirmationModal('Ests seguro de que deseas eliminar esta gift card? Esta accin no se puede deshacer.', (confirmed) => {
                if (confirmed) {
                    giftCards = giftCards.filter(c => c.id !== cardId);
                    saveGiftCards();
                    updateHistoryTable();
                    showNotification('Gift card eliminada.');
                    if (currentGiftCardPreview && currentGiftCardPreview.id === cardId) {
                        if (giftCards.length > 0) {
                            updateGiftCardPreview(giftCards[giftCards.length - 1]);
                        } else {
                            updateGiftCardPreview({
                                cardNumber: 'XXXX-XXXX-XXXX',
                                recipientName: 'NOMBRE DEL DESTINATARIO',
                                amount: 0,
                                model: 'model-classic',
                                bgColor: '#ff6b6b',
                                textColor: '#ffffff',
                                fontFamily: 'Inter, sans-serif',
                                bgImageUrl: ''
                            });
                        }
                    }
                }
            });
        }

        function openRechargeModal(cardId) {
            const card = giftCards.find(c => c.id === cardId);
            if (card) {
                document.getElementById('rechargeCardNumber').value = card.cardNumber;
                document.getElementById('rechargeCardName').value = card.recipientName;
                document.getElementById('rechargeCurrentAmount').value = `$${card.amount.toLocaleString()}`;
                document.getElementById('rechargeAmount').value = '';
                showModal('rechargeModal');
                
                // Guardar referencia para la recarga
                window.currentRechargeCard = card;
            }
        }

        function confirmRecharge() {
            const rechargeAmount = document.getElementById('rechargeAmount').value;
            
            if (!rechargeAmount || parseInt(rechargeAmount) <= 0 || isNaN(parseInt(rechargeAmount))) {
                showNotification('Por favor ingresa un monto vlido para recargar.');
                return;
            }

            if (window.currentRechargeCard) {
                window.currentRechargeCard.amount += parseInt(rechargeAmount);
                window.currentRechargeCard.status = 'active'; // Reactivar si estaba usada
                window.currentRechargeCard.usedDate = null;
                
                saveGiftCards();
                updateHistoryTable();
                closeModal('rechargeModal');
                
                showNotification(`Gift card recargada exitosamente!\nNuevo monto: $${window.currentRechargeCard.amount.toLocaleString()}`);
                if (currentGiftCardPreview && currentGiftCardPreview.id === window.currentRechargeCard.id) {
                    updateGiftCardPreview(window.currentRechargeCard);
                }
            }
        }

        function printCardById(cardId) {
            const card = giftCards.find(c => c.id === cardId);
            if (card) {
                // Set the current card for printing
                currentGiftCardPreview = card;
                printCard(); // Use the general print function
            } else {
                showNotification('Tarjeta no encontrada para imprimir.');
            }
        }

        function updateHistoryTable() {
            const tbody = document.getElementById('historyBody');
            
            // Filter cards based on search and status
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;

            const filteredCards = giftCards.filter(card => {
                const matchesSearch = !searchTerm || 
                    card.recipientName.toLowerCase().includes(searchTerm) ||
                    card.cardNumber.toLowerCase().includes(searchTerm);
                
                const matchesStatus = !statusFilter || card.status === statusFilter;
                
                return matchesSearch && matchesStatus;
            });

            tbody.innerHTML = ''; // Clear existing rows
            
            if (filteredCards.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="no-records">No hay gift cards registradas</td></tr>';
                return;
            }
            
            filteredCards.forEach(card => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${card.cardNumber}</td>
                    <td>${card.recipientName}</td>
                    <td>$${card.amount.toLocaleString()}</td>
                    <td>${card.createdDate}</td>
                    <td><span class="status ${card.status}">${card.status === 'active' ? 'Activa' : 'Usada'}</span></td>
                    <td>${card.usedDate || '-'}</td>
                    <td class="action-buttons">
                        ${card.status === 'active' ? `
                            <button class="action-btn btn-danger" onclick="markAsUsed(${card.id})">Marcar Usada</button>
                        ` : ''}
                        <button class="action-btn btn-warning" onclick="openRechargeModal(${card.id})">Recargar</button>
                        <button class="action-btn btn-secondary" onclick="printCardById(${card.id})">Imprimir</button>
                        <button class="action-btn btn-danger" onclick="deleteCard(${card.id})">Eliminar</button>
                    </td>
                </tr>
            `;
                row.onclick = () => updateGiftCardPreview(card); // Add click event to row
                tbody.appendChild(row);
            });
        }

        function filterHistory() {
            updateHistoryTable(); // Simply call updateHistoryTable to re-render with filters
        }

        function loadGiftCards() {
            giftCards = JSON.parse(localStorage.getItem('giftCards')) || [];
            console.log('Gift cards loaded from localStorage:', giftCards);
            if (giftCards.length > 0) {
                updateGiftCardPreview(giftCards[giftCards.length - 1]); // Show the last created card
            } else {
                 updateGiftCardPreview({
                    cardNumber: 'XXXX-XXXX-XXXX',
                    recipientName: 'NOMBRE DEL DESTINATARIO',
                    amount: 0,
                    model: 'model-classic',
                    bgColor: '#ff6b6b',
                    textColor: '#ffffff',
                    fontFamily: 'Inter, sans-serif',
                    bgImageUrl: ''
                });
            }
        }

        // Custom Confirmation Modal
        let confirmationCallback = null; // For custom confirmation modal

        function showConfirmationModal(message, callback) {
            document.getElementById('confirmationModalMessage').textContent = message;
            confirmationCallback = callback;
            showModal('confirmationModal');
            document.getElementById('confirmActionBtn').onclick = () => {
                if (confirmationCallback) {
                    confirmationCallback(true);
                }
                closeModal('confirmationModal');
            };
        }

           <script>
        // Close modals when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.classList.remove('active');
                }
            });
        };
    </script>

    <!-- CARGA FIREBASE UNA SOLA VEZ -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

    <script>
        // Configuracin nica de Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyBIGUo2-YFCHKF6Nc8I-lB_NmGZiQ5pHJI",
            authDomain: "cryptotracker-8a6fd.firebaseapp.com",
            projectId: "cryptotracker-8a6fd",
            storageBucket: "cryptotracker-8a6fd.firebasestorage.app",
            messagingSenderId: "720112375781",
            appId: "1:720112375781:web:7995dcbd6fe7470aea810c"
        };

        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Cargar catlogo en tiempo real desde etiquetaqr.online
        const grid = document.getElementById('productGrid');

        db.collection('catalogo_publico').doc('showroom_roma')
          .onSnapshot((doc) => {
              if (!grid) return;

              if (doc.exists && doc.data().productos?.length > 0) {
                  const productos = doc.data().productos;
                  grid.innerHTML = '';

                  productos.forEach(p => {
                      const card = document.createElement('div');
                      card.className = 'product-card group';
                      card.innerHTML = `
                          <div class="product-image relative overflow-hidden rounded-t-2xl">
                              <img src="${p.image || 'https://placehold.co/400x400?text=Sin+Foto'}" 
                                   alt="${p.name}" loading="lazy" 
                                   class="w-full h-64 object-cover transition-transform group-hover:scale-110">
                          </div>
                          <div class="product-info p-5">
                              <h3 class="text-xl font-bold text-indigo-600 dark:text-indigo-400 mb-2">${p.name}</h3>
                              ${p.vendedora ? `<p class="text-sm text-gray-600 dark:text-gray-300 mb-2">Vendedora: ${p.vendedora}</p>` : ''}
                              <div class="text-2xl font-bold text-red-600 mb-4">
                                  $${Number(p.offerPrice).toLocaleString('es-AR')}
                                  <span class="text-sm text-gray-500 line-through">$${Number(p.regularPrice).toLocaleString('es-AR')}</span>
                              </div>
                              <a href="https://wa.me/5491124689196?text=Hola!%20Me%20interesa%20${encodeURIComponent(p.name)}%20a%20$${p.offerPrice}%20(ID:${p.id.substring(0,8)})"
                                 target="_blank"
                                 class="btn btn-primary w-full text-center block py-3">
                                  Consultar por WhatsApp
                              </a>
                          </div>
                      `;
                      grid.appendChild(card);
                  });
              } else {
                  grid.innerHTML = `
                      <div class="col-span-full text-center py-20">
                          <p class="text-3xl font-bold text-gray-400 mb-4">Catlogo vaco</p>
                          <p class="text-gray-600 dark:text-gray-400">Sub prendas en <strong>etiquetaqr.online</strong> para que aparezcan aqu al instante</p>
                      </div>
                  `;
              }
          }, (error) => {
              console.error("Error cargando catlogo:", error);
              grid.innerHTML = '<p class="col-span-full text-center text-red-500">Error de conexin con el catlogo</p>';
          });
    </script>
</body>
</html>
